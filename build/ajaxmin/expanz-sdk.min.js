function pop(n,t){for(var r,i=0;i<n.length;i++)if(_.reduce(t,function(r){return r&&t.key===n[i].key},!0))return r=n[i],n.remove(i),r;return null}function isVisibleOnScreen(n){var f=$(window),t=f.scrollTop(),e=f.height(),r=t+e,o=$(n),i=o.offset().top,s=o.height(),u=i+s;return i>=t&&i<r||u>t&&u<=r||s>e&&i<=t&&u>=r}function setVisibility(n,t){n!==undefined&&t!=undefined&&(t?n.show():n.hide())}function supports_history_api(){return!!(window.history&&history.pushState)}function escapeBadCharForURL(n){if(!n)return"";var t=n.replace(/\//g," ");return t=t.replace(/\+/g," "),t=t.replace(/#/g," "),t=t.replace(/%/g," "),t.replace(/ /g,"-")}function escapeHTML(n){return n?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function getObjectSortAscendingFunction(n){return function(t,i){var r=t[n].toLowerCase(),u=i[n].toLowerCase();return r<u?-1:r>u?1:0}}function addPlaceHolderCapabilities(){Modernizr.input.placeholder||$("[placeholder]").focus(function(){var n=$(this);n.val()==n.attr("placeholder")&&(n.val("").removeClass("placeholder"),n.hasClass("password")&&(n.removeClass("password"),(!$.browser.msie||$.browser.msie&&$.browser.version.substr(0,1)>8)&&(this.type="password")))}).blur(function(){var n=$(this);(n.val()===""||n.val()==n.attr("placeholder"))&&(this.type=="password"&&(n.addClass("password"),(!$.browser.msie||$.browser.msie&&$.browser.version.substr(0,1)>8)&&(this.type="text")),n.addClass("placeholder").val(n.attr("placeholder")))}).blur().parents("form").submit(function(){$(this).find("[placeholder]").each(function(){var n=$(this);n.val()==n.attr("placeholder")&&n.val("")})})}function eliminateDuplicates(n){for(var u=n.length,i=[],r={},t=0;t<u;t++)r[n[t]]=0;for(t in r)i.push(t);return i}function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function createMailtoLink(n){return n===null?"":"<a href='mailto:"+n+"'>"+n+"<\/a>"}function getQueryParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i="[\\?&]"+n+"=([^&#]*)",r=new RegExp(i),t=r.exec(window.location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function getQueryHashParameterByName(n){var t=new RegExp(n+"=([^;]*)");return t.test(window.location.hash)?RegExp.$1:null}function loadjscssfile(n,t){var i;t=="js"?(i=document.createElement("script"),i.setAttribute("type","text/javascript"),i.setAttribute("src",n)):t=="css"&&(i=document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",n)),typeof i!="undefined"&&document.getElementsByTagName("head")[0].appendChild(i)}function encode64(n){if(n===undefined)return undefined;var o="",u,t,i="",s,h,f,r="",e=0;do u=n.charCodeAt(e++),t=n.charCodeAt(e++),i=n.charCodeAt(e++),s=u>>2,h=(u&3)<<4|t>>4,f=(t&15)<<2|i>>6,r=i&63,isNaN(t)?f=r=64:isNaN(i)&&(r=64),o=o+keyStr.charAt(s)+keyStr.charAt(h)+keyStr.charAt(f)+keyStr.charAt(r),u=t=i="",s=h=f=r="";while(e<n.length);return o}function decode64(n){if(n===undefined)return undefined;var t="",e,o,s="",h,u,i,f="",r=0;/[^A-Za-z0-9\+\/\=]/g.exec(n)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding."),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");do h=keyStr.indexOf(n.charAt(r++)),u=keyStr.indexOf(n.charAt(r++)),i=keyStr.indexOf(n.charAt(r++)),f=keyStr.indexOf(n.charAt(r++)),e=h<<2|u>>4,o=(u&15)<<4|i>>2,s=(i&3)<<6|f,t=t+String.fromCharCode(e),i!=64&&(t=t+String.fromCharCode(o)),f!=64&&(t=t+String.fromCharCode(s)),e=o=s="",h=u=i=f="";while(r<n.length);return unescape(t)}function getPageUrl(n){return n===undefined?getSiteUrl():window.config._formmappingFormat&&window.config._formmappingFormat.indexOf("[p]")!=-1?window.config._formmappingFormat.replace("[p]",n):n}function getSiteUrl(){return window.config._homepage?"/"+getPageUrl(window.config._homepage):"/"}function parseUserDetails(n){var t=$(n).find("ESA"),i=t.attr("userName");return t=$(n).find("MyManager"),{userName:i,managerName:t.children("FirstName").text()+" "+t.children("LastName").text(),managerPhone:t.children("Phone").text(),managerMobilePhone:t.children("MobilePhone").text(),managerLevel:t.children("Level").text()}}function parseProcessAreas(n){var t=[];return $(n).children("processarea").each(function(){var n=new ProcessArea($(this).attr("id"),$(this).attr("title")),i=parseProcessAreas($(this));i.length>0&&(n.pa=i),$(this).children("activity").each(function(){n.activities.push(new ActivityInfo($(this).attr("name"),$(this).attr("title"),"#",$(this).attr("style"),$(this).attr("image")))}),t.push(n)}),t}function parseRoles(n){if(n===undefined||n.length===0)return null;var t={};return $(n).children("UserRole").each(function(){t[$(this).attr("id")]={id:$(this).attr("id"),name:$(this).text()}}),t}function parseDashboards(n){if(n===undefined||n.length===0)return null;var t={};return $(n).children().each(function(){var i,n,r;for(t[this.tagName]={id:this.tagName},i=0;i<this.attributes.length;i++)n=this.attributes.item(i),t[this.tagName][n.nodeName]=n.nodeValue,r=window.expanz.Dashboards.get(this.tagName+"_"+n.nodeName),r!==null&&r.set({value:n.nodeValue})}),t}function parseExecAnonymousResponse(n){return function(t){var r=$(t).find("ExecAnonymousXResult"),u=!1,f,i;r.length>0&&(f=$(r).find("ESA"),u=boolValue(f.attr("success")),$(r).find("Method").each(function(){var t=boolValue($(this).attr("result")),i=$(this).attr("name"),n=jQuery.Event(i);n.methodResult=t,$("body").trigger(n)}),i=f.attr("serverMessage")||"",!u&&$(t).find("errors").length>0&&(i+=$(t).find("errors").text()),i!==undefined&&i.length>0&&(u?n&&n.info&&n.info(i):n&&n.error&&n.error(i)),$(r).find("Message").each(function(){$(this).attr("type")=="Error"||$(this).attr("type")=="Warning"?n&&n.error&&n.error($(this).text()):$(this).attr("type")=="Info"&&$(this).attr("messageSource")!="System"?n&&n.info&&n.info($(this).text()):$(this).attr("type")=="Info"&&$(this).attr("messageSource")=="System"&&window.expanz.logToConsole("System-Info: "+$(this).text())}))}}function parseGetSessionDataResponse(n){return function(t){var f=parseUserDetails(t),i,r,u;expanz.Storage.setUserDetails(f),i=parseProcessAreas($(t).find("Menu")),r=parseRoles($(t).find("Roles")),expanz.Storage.setRolesList(r),u=parseDashboards($(t).find("Dashboards")),expanz.Storage.setDashboards(u),$(t).find("PublishPreferences").find("Preference").each(function(){window.expanz.Storage.setUserPreference($(this).attr("key"),$(this).attr("value"))}),$.get("./formmapping.xml",function(t){expanz.Storage.setFormMapping(t),$(t).find("activity").each(function(){var t=$(this).attr("name"),r=getPageUrl($(this).attr("form")),u=$(this).attr("style")||"",n=[];$(this).find("gridview").each(function(){var t=new GridViewInfo($(this).attr("id"));n.push(t)}),fillActivityData(i,r,t,u,n)}),expanz.Storage.setProcessAreaList(i),$(t).find("activity").each(function(){if($(this).attr("default")=="true"){n&&n.success&&n.success($(this).attr("form"));return}})})}}function parseResponse(n,t){return function(i){var r,u;$(i).find("errors").each(function(){$(i).find("errors").text().indexOf(":Your session cannot be contacted")!=-1&&expanz.views.redirect(window.expanz.getMaintenancePage())}),r=$(i).find("ExecXResult"),(r===null||r.length===0)&&(r=$(i).find("ExecAnonymousXResult")),r&&(u=r.children("ESA"),u.length!==0&&u.children().each(function(){var i=this;switch(i.nodeName){case"Activity":parseActivityResponse(i,t);break;case"ActivityRequest":parseActivityRequestResponse(i);break;case"Messages":parseApplicationMessagesResponse(i);break;case"Dashboards":parseDashboardsResponse(i);break;case"Files":parseFilesResponse(i,n,t);break;default:expanz.logToConsole("Unexpected element '"+i.nodeName+"' found in response. Ignored.")}})),n.set({deltaLoading:{isLoading:!1,initiator:t}})}}function parseActivityResponse(n,t){var r=$(n),e=r.attr("activityHandle"),u=null,i,f;t&&t!==null&&t.type==="CreateActivity"?(u=window.expanz.findOpenActivityViewByModel(t.activityModel),t.activityModel.set({handle:r.attr("activityHandle")}),expanz.Storage.setActivityHandle(t.activityModel.get("handle"),t.activityModel.get("name"),t.activityModel.get("style"))):u=window.expanz.findOpenActivityViewByHandle(e),u!=null?(i=u.model,i.messageCollection.reset(),r.children().each(function(){var n=this;switch(n.nodeName){case"Field":parseFieldResponse(n,i);break;case"Method":parseMethodResponse(n,i);break;case"Data":parseDataResponse(n,i,u);break;case"Messages":parseActivityLevelMessagesResponse(n,i);break;case"UIMessage":parseUIMessageResponse(n,i);break;case"ModelObject":parseModelObjectResponse(n,i);break;case"Graph":expanz.logToConsole("Graph data is not currently supported by this SDK. Ignored.");break;case"ContextMenu":parseContextMenuResponse(n,i);break;case"CustomContent":expanz.logToConsole("CustomContent data is not currently supported by this SDK. Ignored.");break;case"Types":break;default:expanz.logToConsole("Unexpected element '"+n.nodeName+"' found in response. Ignored.")}}),r.attr("closeWindow")!==undefined&&boolValue(r.attr("closeWindow"))&&i.closeActivity(),f=r.attr("focusField"),f!==undefined&&i.setFieldFocus(f),i.set({loading:!1})):expanz.logToConsole("An activity with handle '"+e+"' is not found!")}function parseFieldResponse(n,t){var i=$(n),r=i.attr("id");_.each(t.fields.where({fieldId:r}),function(n){n.publish(i)})}function parseMethodResponse(n,t){var r=$(n),u=r.attr("id"),i=t.methods.get(u);i&&i!==undefined&&i.publish(r)}function parseDataResponse(n,t,i){var r=$(n),u=r.attr("id"),o=r.attr("pickField"),s=r.attr("contextObject"),e,l;if(u=="picklist"){var h=u+o.replace(/ /g,"_"),c=new expanz.models.ClientMessage({id:h,title:o,text:"",parent:t}),f=new window.expanz.views.PicklistWindowView({id:c.id,model:c},$("body"));expanz.Factory.bindDataControls(i,f.$el.parent()),e=t.dataPublications.get(h),fillGridModel(e,r),f.center(),e.updateRowSelected=function(n,i){var r=window["picklistUpdateRowSelected"+i],u,e;typeof r=="function"?r(n):(u={id:n,contextObject:s,type:i},e=[{name:"contextObject",value:s}],expanz.net.MethodRequest("SetIdFromContext",e,u,t)),f.close()}}else l=t.dataPublications.getChildrenByAttribute("dataId",u),_.each(l,function(n){n.get("renderingType")=="grid"||n.get("renderingType")=="popupGrid"||n.get("renderingType")=="rotatingBar"?(fillGridModel(n,r),n.actionSelected=function(n,i,r){expanz.net.MethodRequest(i,r,null,t)},n.menuActionSelected=function(n,t){expanz.net.CreateMenuActionRequest(r.get("parent"),n,null,t,"1",!0)},n.contextMenuSelected=function(n,t,i){expanz.net.CreateContextMenuRequest(this.get("parent"),n,t,i)}):(n.unset("xml",{silent:!0}),n.set({xml:r[0]}))}),_.each(t.fields.where({fieldId:u}),function(n){n.publishData(r)})}function parseActivityLevelMessagesResponse(n,t){var i=$(n);i.children("Message").each(function(){var n=$(this),r={type:n.attr("type"),key:n.attr("key"),source:n.attr("source"),messageSource:n.attr("messageSource"),message:n.text()},i;t.messageCollection.addMessage(r),i=r.source,i&&i!==undefined&&_.each(t.fields.where({fieldId:i}),function(n){n.set({errorMessage:t.messageCollection.transformMessage(r.message),error:!0})})})}function parseUIMessageResponse(n,t){var i=$(n),r=new expanz.models.ClientMessage({id:"ExpanzClientMessage",title:i.attr("title"),text:i.attr("text"),parent:t}),u;i.find("Action").each(function(){var n=$(this),i=[],u;$("Request > Method",n)[0]&&$("Request > Method",n)[0].attributes.length>0&&_.each($("Request > Method",n)[0].attributes,function(n){n.name!="name"&&i.push({name:n.name,value:n.value})}),u=new expanz.models.Method({id:$("Request > Method",n)[0]?$($("Request > Method",n)[0]).attr("name"):"close",label:n.attr("label"),response:$("Response",n)[0]?$($("Response",n)[0]).children():undefined,parent:t,methodAttributes:i}),r.actions.add(u)}),u=new window.expanz.views.UIMessage({id:r.id,model:r},$("body"))}function parseModelObjectResponse(){}function parseContextMenuResponse(n,t){var i=window.expanz.currentContextMenu,r;i!==undefined&&i!==null&&(i.loadMenu!==undefined?i.loadMenu(n,t):(r=new expanz.models.ContextMenu({id:i.id+"_contextmenu",parentActivity:t}),r.loadMenu(n,t),i.setContextMenu(r)))}function parseActivityRequestResponse(n){var t=$(n),i=t.attr("id"),r=t.attr("key"),u=t.attr("style")||"";window.expanz.openActivity(i,u,r)}function parseApplicationMessagesResponse(n){var i=$(n),t="";i.children("Message").each(function(){var n=$(this),i=/Session .* not found/.test(n.text()),r=/Activity .* not found/.test(n.text());i||r?window.expanz.security.showLoginPopup():(t+="\n\n",t+=n.text())}),t.length!==0&&alert("The following message(s) have been returned from the server:"+t)}function parseDashboardsResponse(n){var i=$(n),t=parseDashboards(i.find("Dashboards"));t!==null&&expanz.Storage.setDashboards(t)}function parseFilesResponse(n,t,i){var r=$(n);r.children("File").each(function(){var n=$(this);n.attr("field")!==undefined&&n.attr("path")!==undefined?(window.expanz.logToConsole("Blob found by field: "+n.attr("field")+" - "+n.attr("path")),expanz.net.GetBlobRequest(n.attr("field"),t,i)):n.attr("name")!==undefined?(window.expanz.logToConsole("File found by name: "+n.attr("name")),expanz.net.GetFileRequest(n.attr("name"),t,i)):window.expanz.logToConsole("Not yet implemented")})}function parseCloseActivityResponse(n){return function(t){var r=$(t).find("ExecXResult"),i;if(t&&r&&(i=$(r).find("ESA"),i&&$(i).attr("success")===1&&n&&n.success))return n.success(!0),!0;n&&n.error&&n.error(!0);return}}function parseReleaseSessionResponse(n){return function(t){var i=$(t).find("ReleaseSessionResult").text();if(i==="true"&&n&&n.success){n.success(i);return}n&&n.error&&n.error(i);return}}function fillActivityData(n,t,i,r,u){$.each(n,function(n,f){$.each(f.activities,function(n,f){f.name==i&&f.style==r&&(f.url=t,f.gridviews=u)}),fillActivityData(f.pa,t,i,r,u)})}function fillGridModel(n,t){n.clear(),n.set({source:$(t).attr("source")});var i=Object();_.each($(t).find("Column"),function(t){var r=$(t).attr("field")?$(t).attr("field"):$(t).attr("id");r=r.replace(/\./g,"_"),i[$(t).attr("id")]=r,n.addColumn($(t).attr("id"),$(t).attr("field"),$(t).attr("label"),$(t).attr("datatype"),$(t).attr("width"))}),_.each($(t).find("Row"),function(t){var r=$(t).attr("id");n.addRow(r,$(t).attr("type")||$(t).attr("Type"),$(t).attr("displayStyle")),_.each($(t).find("Cell"),function(t){t=serializeXML(t),n.addCell(r,$(t).attr("id"),$(t).text(),i[$(t).attr("id")],$(t).attr("sortValue"))})}),n.trigger("update:grid")}function ActivityInfo(n,t,i,r,u){this.name=n,this.title=t,this.url=i,this.style=r||"",this.img=u!==undefined?u:"assets/images/"+n+r+".png",this.gridviews=[]}function ProcessArea(n,t){this.id=n,this.title=t,this.activities=[],this.pa=[]}function GridViewInfo(n){function t(n,t){this.field=n,this.width=t}this.id=n,this.columns=[],this.addColumn=function(n,i){this.columns.push(new t(n,i))}}var keyStr;$(function(){window.expanz=window.expanz||{},window.expanz.Collection=Backbone.Collection.extend({initialize:function(n){this.attrs={},this.setAttr(n);return},getAttr:function(n){return this.attrs[n]?this.attrs[n]:!1},setAttr:function(n){var t,i;for(t in n)t==="id"&&(this.id=n[t]),i=this.attrs[t],this.attrs[t]=n[t],i!=this.attrs[t]&&this.trigger("update:"+t);return!0},getChildrenByAttribute:function(n,t){return this.filter(function(i){return i!==undefined&&i.get(n)===t})},getFirstChildByAttribute:function(n,t){var i=this.getChildrenByAttribute(n,t);return i.length!==0?i[0]:null},destroy:function(){this.each(function(n){n.destroy()});return}})}),$(function(){window.expanz=window.expanz||{},window.expanz.Component=Backbone.View.extend({componentName:"",activity:null,modules:[],initialize:function(){var n=this;_.each(this.modules,function(t){var i=window.expanz.html.findComponentModuleElement(n.componentName,t);i!==undefined&&i.each(function(){var r,u;i.attr("loaded")===undefined&&(r=n["render"+t+"Module"]($(this)),this.canHaveChildren===undefined||this.canHaveChildren?$(this).append(r):(u=document.createElement("div"),u.innerHTML=r,this.parentElement.appendChild(u)),i.attr("loaded","1"))})})},_executeAfterInitalize:function(n){_.each(this.modules,function(t){var i=window.expanz.html.findComponentModuleElement(n.componentName,t);i!==undefined&&i.each(function(){n["_executeAfterRender"+t+"Module"]&&n["_executeAfterRender"+t+"Module"]($(this))})})}})}),$(function(){window.expanz=window.expanz||{},window.expanz.Factory={createLoginView:function(n){var t=$(n),i=new window.expanz.models.Login;return new window.expanz.views.LoginView({el:n,id:t.attr("name"),type:t.attr("type"),model:i})},createActivityView:function(n){var t=$(n),r=new expanz.models.Activity({name:t.attr("name"),title:t.attr("title"),url:t.attr("url"),key:t.attr("key"),style:t.attr("activityStyle"),optimisation:t.attr("optimisation")?boolValue(t.attr("optimisation")):!0,allowAnonymous:t.attr("allowAnonymous")?boolValue(t.attr("allowAnonymous")):!1}),i=new expanz.views.ActivityView({el:n,id:t.attr("name"),key:t.attr("key"),model:r});return expanz.Factory.bindMessageControl(i),expanz.Factory.bindMethods(i),expanz.Factory.bindDataControls(i),expanz.Factory.bindFields(i),i},bindMessageControl:function(n){var r=n.model,t=n.$el.find("[bind=messageControl]"),i=null,u;t.length===0?(window.messageControlView===null&&(t=$("[bind=messageControl]"),t.length!==0&&(i=$(t),window.messageControlView=new expanz.views.MessagesView({id:i.attr("id"),collection:new expanz.models.MessageCollection}),i.html(window.messageControlView.render().el))),window.messageControlView!==null&&(r.messageCollection=window.messageControlView.collection)):(i=$(t),u=new expanz.views.MessagesView({id:i.attr("id"),collection:r.messageCollection}),i.html(u.render().el)),n.messageControl=t},bindFields:function(n){var t=n.model,u=expanz.Factory.createFieldViews(n.$el.find("[bind=field]")),r=expanz.Factory.createDataFieldViews(n.$el.find("[bind=datafield]")),f=expanz.Factory.createVariantFieldViews(n.$el.find("[bind=variantfield]")),e=expanz.Factory.createDashboardFieldViews(n.$el.find("[bind=dashboardfield]")),o=expanz.Factory.createDependantFieldViews(n.$el.find("[bind=dependant]")),i=function(n){var i=n.model,r;i.set({parent:t},{silent:!0}),t.fields.add(i),i.get("anonymousBoundMethod")!==null&&i.get("anonymousBoundMethod")!==""&&(r=t.methods.get(i.get("anonymousBoundMethod")),r&&r.addAnonymousElement(i))};_.each(u,i),_.each(r,i),_.each(f,i),_.each(o,i),_.each(e,function(n){var t=n.model,i=expanz.Storage.getDashboardFieldValue(t.get("dashboardName"),t.get("name"));t.set({value:i||""}),expanz.Dashboards.add(t)}),_.each(r,function(n){t.dataPublications.add(n.dataModel)})},bindMethods:function(n){var t=n.model,i=expanz.Factory.createMethodViews(n.$el.find("[bind=method]"));_.each(i,function(i){var r=i.model;r.set({parent:t},{silent:!0}),t.methods.add(r),n.addMethodView(i)})},bindDataControls:function(n,t){var i=n.model,r;t===undefined&&(t=n.el),r=expanz.Factory.createDataControlViews(i.get("name"),i.get("style"),$(t).find("[bind=DataControl]")),_.each(r,function(n){var t=n.model,r,u;t.set({parent:i,activityId:i.get("name")}),r=i.dataPublications.get(t.id),r!==undefined&&i.dataPublications.remove(r),i.dataPublications.add(t),t.get("anonymousBoundMethod")!==null&&t.get("anonymousBoundMethod")!==""&&(u=i.methods.get(t.get("anonymousBoundMethod")),u&&u.addAnonymousElement(t))})},createFieldViews:function(n){var t=[];return _.each(n,function(n,i){var r=$(n),u=r.attr("fieldId")||r.attr("name")||r.attr("id"),f=u+"_"+i,e=new expanz.models.Field({id:f,fieldId:u,anonymousBoundMethod:r.attr("anonymousBoundMethod")}),o=new expanz.views.FieldView({el:n,id:f,className:r.attr("class"),model:e});t.push(o)}),t},createDataFieldViews:function(n){var t=[];return _.each(n,function(n,i){var r=$(n),f=r.attr("fieldId")||r.attr("name")||r.attr("id"),u=f+"_"+i,e=new expanz.models.Field({id:u,fieldId:f,anonymousBoundMethod:r.attr("anonymousBoundMethod")}),o=new expanz.models.data.DataControl({id:u,dataId:r.attr("dataId")||r.attr("id")||r.attr("fieldId")||r.attr("name")||r.attr("query")||r.attr("populateMethod"),populateMethod:r.attr("populateMethod"),type:r.attr("type"),contextObject:r.attr("contextObject"),autoPopulate:r.attr("autoPopulate"),renderingType:r.attr("renderingType"),selectionChangeAnonymousMethod:r.attr("selectionChangeAnonymousMethod"),selectionChangeAnonymousContextObject:r.attr("selectionChangeAnonymousContextObject"),anonymousBoundMethod:r.attr("anonymousBoundMethod")}),s=new expanz.views.DataFieldView({el:n,id:u,className:r.attr("class"),model:e,dataModel:o});t.push(s)}),t},createVariantFieldViews:function(n){var t=[];return _.each(n,function(n,i){var r=$(n),u=r.attr("fieldId")||r.attr("name")||r.attr("id"),f=u+"_"+i,e=new expanz.models.Field({id:f,fieldId:u}),o=new expanz.views.VariantFieldView({el:n,id:f,className:r.attr("class"),model:e});t.push(o)}),t},createDashboardFieldViews:function(n){var t=[];return _.each(n,function(n){var i=$(n),r=new expanz.models.DashboardField({id:i.attr("dashboardName")+"_"+i.attr("name"),name:i.attr("name"),dashboardName:i.attr("dashboardName")}),u=new expanz.views.FieldView({el:n,id:r.get("id"),className:i.attr("class"),model:r});t.push(u)}),t},createDependantFieldViews:function(n){var t=[];return _.each(n,function(n){var i=$(n),r=new expanz.models.Bindable({id:i.attr("name")}),u=new expanz.views.DependantFieldView({el:n,id:r.get("id"),className:i.attr("class"),model:r});t.push(u)}),t},createMethodViews:function(n){var t=[];return _.each(n,function(n){var i=$(n),u=[],r,f;i.attr("methodAttributes")&&_.each(i.attr("methodAttributes").split(";"),function(n){var t=n.split(":");t.length==2&&u.push({name:t[0],value:t[1]})}),r=new expanz.models.Method({id:i.attr("name"),contextObject:i.attr("contextObject"),methodAttributes:u}),f=new expanz.views.MethodView({el:n,id:r.get("id"),className:i.attr("class"),model:r}),t.push(f)}),t},createDataControlViews:function(n,t,i){var r=[];return _.each(i,function(i){var u=$(i),f,e,h,o,s;u.attr("renderingType")=="grid"||u.attr("renderingType")=="popupGrid"||u.attr("renderingType")=="rotatingBar"?(f=new expanz.models.data.Grid({id:u.attr("id"),dataId:u.attr("dataId")||u.attr("id")||u.attr("name")||u.attr("query")||u.attr("populateMethod"),query:u.attr("query"),fieldName:u.attr("fieldName")||u.attr("dataId"),populateMethod:u.attr("populateMethod"),autoPopulate:u.attr("autoPopulate"),contextObject:u.attr("contextObject"),renderingType:u.attr("renderingType"),selectionChangeAnonymousMethod:u.attr("selectionChangeAnonymousMethod"),selectionChangeAnonymousContextObject:u.attr("selectionChangeAnonymousContextObject"),anonymousBoundMethod:u.attr("anonymousBoundMethod")}),e=new expanz.views.GridView({el:i,id:f.get("id"),className:u.attr("class"),itemsPerPage:u.attr("itemsPerPage"),templateName:u.attr("templateName"),isHTMLTable:u.attr("isHTMLTable"),enableConfiguration:u.attr("enableConfiguration"),noItemText:u.attr("noItemText"),model:f}),h=expanz.Storage.getFormMapping(),o=_.find($(h).find("activity"),function(i){return $(i).attr("name")===n&&$(i).attr("style")===t}),o&&(s=_.find($(o).find("gridview"),function(n){return $(n).attr("id")===f.get("id")}),s&&_.each($(s).find("action"),function(n){var t=[],i,r;_.each($(n).find("param"),function(n){t.push({name:$(n).attr("name"),value:$(n).attr("value"),label:$(n).attr("label"),bindValueFromCellId:$(n).attr("bindValueFromCellId")})}),i=$(n).attr("methodName")||$(n).attr("menuAction")||$(n).attr("contextMenu"),r=$(n).attr("methodName")?"method":$(n).attr("menuAction")?"menuAction":"contextMenu",f.addAction(r,$(n).attr("id"),$(n).attr("label"),$(n).attr("width"),i,t)}))):(f=new expanz.models.data.DataControl({id:u.attr("id"),dataId:u.attr("id")||u.attr("name")||u.attr("query")||u.attr("populateMethod"),fieldName:u.attr("fieldName")||u.attr("dataId"),populateMethod:u.attr("populateMethod"),type:u.attr("type"),contextObject:u.attr("contextObject"),autoPopulate:u.attr("autoPopulate"),renderingType:u.attr("renderingType"),selectionChangeAnonymousMethod:u.attr("selectionChangeAnonymousMethod"),selectionChangeAnonymousContextObject:u.attr("selectionChangeAnonymousContextObject"),anonymousBoundMethod:u.attr("anonymousBoundMethod")}),e=u.attr("renderingType")=="checkboxes"?new expanz.views.CheckboxesView({el:i,id:f.get("id"),className:u.attr("class"),model:f}):u.attr("renderingType")=="radiobuttons"?new expanz.views.RadioButtonsView({el:i,id:f.get("id"),className:u.attr("class"),model:f}):new expanz.views.DataControlView({el:i,id:f.get("id"),className:u.attr("class"),model:f})),r.push(e)}),r}}}),$(function(){window.expanz=window.expanz||{},window.expanz.html=window.expanz.html||{},window.expanz.html.busyIndicator=function(){},window.expanz.html.startDiv=function(n){return n||(n=""),'<div class="'+n+'" >'},window.expanz.html.endDiv=function(){return"<\/div>"},window.expanz.html.clearBoth=function(){return'<div style="clear:both"><\/div>'},window.expanz.html.renderHeaderGridField=function(n,t){var i="gridHeader";return n||(n=""),n!==""&&(i+=" gridHeader"+n),t||(t=100),'<div class="'+i+'" style="width:'+t+'px;float:left">'+n+"<\/div>"},window.expanz.html.renderGridTemplateField=function(n,t){return t||(t=100),'<div class="'+n+'" style="width:'+t+'px;float:left"><%= data.'+n+" %>&nbsp;<\/div>"},window.expanz.html.renderField=function(n,t,i,r,u){u||(u="false");var f="";return f+='<div showError="'+u+'" id="'+n+'"  bind="field" name="'+n+'" class="field '+n+'" anonymousBoundMethod='+r+">",t===!0&&(f+='<label attribute="label"><\/label>'),f+='<input type="text" attribute="value"  class="k-textbox" placeholder="'+i+'"/>',f+"<\/div>"},window.expanz.html.renderReadOnlyField=function(n,t,i,r){var u="",f=i?"float:left;":"";return f+=r?"width:"+r+"px":"",u+='<div style="'+f+'" id="'+n+'"  bind="field" name="'+n+'" class="readonlyField '+n+'">',t===!0&&(u+='<div class="fieldLabel" style="float:left"><label attribute="label"><\/label><\/div> '),u+='<div class="fieldValue"><label attribute="value"><\/label><\/div><div style="clear:both" ><\/div>',u+"<\/div>"},window.expanz.html.renderMethod=function(n,t,i,r,u){var s=i?i:"methodButton",e=r?' contextObject = "'+r+'" ':"",o=u?' style="display:none" ':"",f=""+('<div bind="method" id="'+n+'" name="'+n+'" '+e+o+' class="'+i+'">');switch(i){case"button":f+='<button attribute="submit" type="button">'+t+"<\/button>";break;default:f+='<a attribute="submit"><span>'+t+"<\/span><\/button>"}return f+"<\/div>"},window.expanz.html.renderHeader=function(n,t){var i="";return n||(n=""),t||(t=getSiteUrl()),i+='<div id="headBackground">',i+='<div class="centerLogoArea">',i+='<div id="siteName">'+n+"<\/div>",t!==""&&(i+='<a href="'+t+'"><div id="logo"><\/div><\/a>'),i+="<\/div>",i+"<\/div>"},window.expanz.html.renderFooter=function(n,t){var i="";return i+='<div class="footer">',i+='<div class="footerContainer">',i+='<div class="left footerCopyright">',n||(n=""),n!==""&&(i+="<div>"+n+"<\/div>"),i+='<div class="footerLinks">',t||(t=""),t!==""&&(i+=t),i+="<\/div>",i+="<\/div>",i+='<div class="right topContainer">',i+='<a class="top" href="javascript:void(0);"> Top&nbsp;&nbsp;&nbsp; <\/a>',i+="<\/div>",i+="<\/div>",i+"<\/div>"},window.expanz.html.addNameToImageURL=function(n,t){if(!n||!t)return"";var i=n.replace(/\\/g,"/").lastIndexOf("/");return i>=0?n.splice(i+1,0,escapeBadCharForURL(t)+"-"):""},window.expanz.html.isEmpty=function(n){return n===undefined?!0:n===""},window.expanz.html.findComponentModuleElement=function(n,t){var i=n+"\\:"+t;return $(i).length>0?$(i):(i="."+n+"-"+t,$(i).length>0)?$(i):undefined}}),String.prototype.splice=function(n,t,i){return this.slice(0,n)+i+this.slice(n+Math.abs(t))},Array.prototype.remove=function(n,t){var i=this.slice((t||n)+1||this.length);return this.length=n<0?this.length+n:n,this.push.apply(this,i)},Array.prototype.clone=function(){return JSON.parse(JSON.stringify(this))},Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length,t=Number(arguments[1])||0;for(t=t<0?Math.ceil(t):Math.floor(t),t<0&&(t+=i);t<i;t++)if(t in this&&this[t]===n)return t;return-1}),String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1},serializeXML=function(n){if(n.xml)return n.xml;if(typeof XMLSerializer!="undefined")return(new XMLSerializer).serializeToString(n);throw"Browser cannot serialize objects to XML";},boolValue=function(n){return n===null||n===undefined||n.length===0?!1:(n=n.toUpperCase(),n=="1"||n=="TRUE"||n=="Y"||n=="YES"||n=="ON"||n=="1.00"||n=="ENABLED")?!0:!1},boolString=function(n){return n?"1":"0"},isImageValid=function(n){if(!n)return!1;n=n.replace(/\\/,"/");var t=n.lastIndexOf(".");return t>=0?(n=n.substring(t),n.indexOf("/")>0)?!1:!0:!1},addDollar=function(n){return n===null||n===""?"":"$ "+n},addPercent=function(n){return n===null||n===""?"":n+"%"},Object.size=function(n){var t=0,i;for(i in n)n.hasOwnProperty(i)&&t++;return t},jQuery.fn.center=function(n){return op=jQuery.extend({vertical:!0,horizontal:!0},n),this.each(function(){var n=jQuery(this),i=n.width(),r=n.height(),u=parseInt(n.css("padding-top"),10),f=parseInt(n.css("padding-bottom"),10),e=parseInt(n.css("border-top-width"),10),o=parseInt(n.css("border-bottom-width"),10),s=(e+o)/2,h=(u+f)/2,c=n.parent().css("position"),l=i/-2,a=r/-2-h-s,t={position:"absolute"};op.vertical&&(t.height=r,t.top="50%",t.marginTop=a),op.horizontal&&(t.width=i,t.left="50%",t.marginLeft=l),c=="static"&&n.parent().css("position","relative"),n.css(t)})},keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(n){n.fn.getAttributes=function(){var t={};return this.length?(n.each(this[0].attributes,function(n,i){t[i.name]=i.value}),t):this},n.fn.vAlign=function(t){return this.each(function(){var i=n(this).height()||t,r=n(this).parent().height(),u=Math.ceil((r-i)/2);n(this).css("margin-top",u)})}}(jQuery),$(function(){addPlaceHolderCapabilities()}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Bindable=Backbone.Model.extend({destroy:function(){}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Field=expanz.models.Bindable.extend({_type:"Field",defaults:function(){return{error:!1}},update:function(n){this.get("parent").isAnonymous()?this.set({lastValue:n.value}):expanz.net.DeltaRequest(this.get("fieldId"),n.value,this.get("parent"));return},publish:function(n){if(n.attr!==undefined){var t=["id","value","visualType"],i=["disabled","hidden","null","valid"],r=this;_.each(n[0].attributes,function(n){var e=_.indexOf(t,n.name)===-1,u,f;e&&(u=n.value,f=_.indexOf(i,n.name)!==-1,f&&(u=boolValue(u)),r.set(n.name,u))}),n.is("[value]")&&this.set({value:n.attr("value")=="$longData$"?n.text():n.attr("value")}),n.is("[visualType]")&&this.set({visualType:n.attr("visualType")}),boolValue(n.attr("valid"))&&this.get("errorMessage")!==undefined&&this.set({errorMessage:undefined}),this.get("datatype")&&this.get("datatype").toLowerCase()==="blob"&&n.attr("url")&&this.set({value:n.attr("url")})}else window.expanz.logToConsole("window.expanz.models.Field: xml.attr is undefined")},publishData:function(n){n.attr!==undefined&&(this.unset("data",{silent:!0}),this.set({data:n}))},setFocus:function(){this.trigger("setFocus")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.DashboardField=window.expanz.models.Field.extend({update:function(){return}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Method=expanz.models.Bindable.extend({_type:"Method",submit:function(){var i,n,t,u,r;for(window.expanz.currentContextMenu=this,i=[],this.get("anonymousFields")&&$.each(this.get("anonymousFields"),function(n,t){t instanceof expanz.models.data.DataControl?i.push({id:t.get("dataId"),value:t.get("lastValues")||""}):i.push({id:t.get("id"),value:t.get("lastValue")||""})}),n=[{name:"contextObject",value:this.get("contextObject")}],this.get("methodAttributes")&&(n=n.concat(this.get("methodAttributes"))),n=n.clone(),t=0;t<n.length;t++)u=n[t].value,r=/^%(.*)%$/.exec(u),r&&(n[t].value=$("#"+r[1]).val());expanz.net.MethodRequest(this.get("id"),n,null,this.get("parent"),i);return},publish:function(n){n.attr!==undefined?n.attr("label")&&this.set({label:n.attr("label")}):window.expanz.logToConsole("window.expanz.models.Method: xml.attr is undefined")},addAnonymousElement:function(n){var t=this.get("anonymousFields");(t===undefined||t===null)&&(t=[]),t.push(n),this.set({anonymousFields:t})},setContextMenu:function(n){this.contextMenuModel=n,this.trigger("contextMenuLoaded")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.MenuAction=window.expanz.models.Bindable.extend({_type:"MenuAction",initialize:function(){},menuItemSelected:function(n){expanz.net.CreateMenuActionRequest(this.get("parentActivity"),null,null,n);return}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.ContextMenu=expanz.Collection.extend({model:expanz.models.MenuAction,initialize:function(n){this.loading=!1,this.id=n.id},loadMenu:function(n,t){var i=$(n),r,u;this.reset(),r=this,u=i.attr("defaultAction"),i.children().each(function(){var n=$(this);this.nodeName==="MenuItem"?r.add({action:n.attr("action"),text:n.attr("text"),clientAction:n.attr("clientAction"),isDefaultAction:u===n.attr("action"),parentActivity:t}):this.nodeName==="Menu"}),this.trigger("menuLoaded")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Login={},window.expanz.models.Login=expanz.models.Bindable.extend({defaults:function(){return{error:!1,isLoggingIn:!1}},initialize:function(){this.messageCollection=new expanz.models.MessageCollection},login:function(n,t,i){var r=this,u;this.set({isLoggingIn:!0}),u=function(n){n&&n.length>0?this.get("error").set({value:n}):expanz.net.GetSessionDataRequest({success:function(n){i?window.location.reload():expanz.views.redirect(n)},error:function(){r.set({isLoggingIn:!1})}})},expanz.net.CreateSessionRequest(n,t,{success:u,error:function(n){r.messageCollection.addErrorMessageByText(n),r.set({isLoggingIn:!1})}})}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Dashboards=expanz.Collection.extend({model:expanz.models.DashboardField})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Message=expanz.models.Bindable.extend({_type:"Message",initialize:function(){},publish:function(n){n.attr!==undefined||window.expanz.logToConsole("window.expanz.models.Message: xml.attr is undefined")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.MessageCollection=expanz.Collection.extend({model:expanz.models.Message,initialize:function(){this.loading=!1,this.loadMessageResources()},addMessage:function(n){this._addMessageByText(n.message,n.type)},loadMessageResources:function(){window.config._useBundle!==!1&&jQuery.i18n.properties({name:"Messages",path:"assets/bundle/",mode:"map",language:" ",cache:!0,callback:function(){}})},addErrorMessageByText:function(n){this._addMessageByText(n,"error")},addWarningMessageByText:function(n){this._addMessageByText(n,"warning")},addInfoMessageByText:function(n){this._addMessageByText(n,"info")},addSuccessMessageByText:function(n){this._addMessageByText(n,"success")},transformMessage:function(n){if(window.config._useBundle===!0){var t=null;typeof window.expanz.findMessageKey=="function"?t=window.expanz.findMessageKey(n):expanz.logToConsole("window.expanz.findMessageKey not found in your implementation"),t!==null&&(n=jQuery.i18n.prop(t.key,t.data))}return n},_addMessageByText:function(n,t){n=this.transformMessage(n),n!==""&&(this.add({type:t,message:n}),window.config._showAllMessages===!0&&window.expanz.logToConsole(t+": "+n))},addErrorMessageByKey:function(n,t){this._addMessageByKey(n,t,"error")},addInfoMessageByKey:function(n,t){this._addMessageByKey(n,t,"info")},addWarningMessageByKey:function(n,t){this._addMessageByKey(n,t,"warning")},addSuccessMessageByKey:function(n,t){this._addMessageByKey(n,t,"success")},_addMessageByKey:function(n,t,i,r){var u=jQuery.i18n.prop(n,t),f;u&&u.length>0?(f={type:i,key:n,source:null,messageSource:null,message:u,popup:r},this.add(f)):window.config._showAllMessages===!0&&window.expanz.logToConsole(i+": "+n+t)}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.Activity=Backbone.Model.extend({isAnonymous:function(){return!this.get("handle")},defaults:{},initialize:function(){this.fields=new expanz.Collection,this.methods=new expanz.Collection,this.dataPublications=new expanz.Collection,this.messageCollection=new expanz.models.MessageCollection,this.loading=!1},load:function(){expanz.net.CreateActivityRequest(this,this.callbacks)},closeActivity:function(){this.trigger("closingActivity"),window.expanz.Storage.clearActivityHandle(this.get("name"),this.get("style")),window.expanz.OnActivityClosed(this.get("handle")),expanz.net.CloseActivityRequest(this.get("handle")),this.destroy()},setFieldFocus:function(n){var t=this.fields.where({fieldId:n});t.length!==0&&t[0].setFocus()},destroy:function(){}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.ClientMessage=expanz.models.Bindable.extend({initialize:function(){this.actions=new expanz.Collection}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.data=window.expanz.models.data||{},window.expanz.models.data.DataControl=Backbone.Model.extend({initialize:function(){this.rows=new expanz.models.data.RowCollection},update:function(n){expanz.net.DeltaRequest(this.get("dataId"),n.value,this.get("parent"));return},updateItemSelected:function(n,t){var r,i,u;this.get("parent").isAnonymous()?this.get("renderingType")=="tree"?(r=[{id:this.get("dataId"),value:n}],expanz.net.MethodRequest(this.get("selectionChangeAnonymousMethod"),[{name:"contextObject",value:this.get("selectionChangeAnonymousContextObject")}],null,this.get("parent"),r,t)):(i=this.get("lastValues"),i||(i=""),n<0?(u=new RegExp("("+-n+";)|(;?"+-n+"$)","g"),i=i.replace(u,"")):(i.length>0&&(i+=";"),i+=n),this.set({lastValues:i})):this.get("id")=="documents"?expanz.net.CreateMenuActionRequest(this.get("parent"),n,"File",null,"1",t):expanz.net.DeltaRequest(this.get("fieldName"),n,this.get("parent"),t)}})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.data=window.expanz.models.data||{},window.expanz.models.data.Cell=expanz.models.Bindable.extend({defaults:function(){return{selected:!1}}}),window.expanz.models.data.CellCollection=expanz.Collection.extend({model:expanz.models.data.Cell})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.data=window.expanz.models.data||{},window.expanz.models.data.Row=expanz.models.Bindable.extend({defaults:function(){return{selected:!1}},initialize:function(){this.cells=new expanz.models.data.RowCollection},getAllCells:function(){return this.cells.reject(function(n){return n.get("value")===undefined},this)},getCellsMapByField:function(){var i=this.cells.reject(function(n){return n.get("value")===undefined},this),n={},t={};return _.each(i,function(i){var r=i.get("field")||i.get("label");n[r]=i.get("value"),t[r]=i.get("sortValue")||i.get("value")}),n.rowId=this.id,n.rowType=this.type,{data:n,sortedValues:t}}}),window.expanz.models.data.RowCollection=expanz.Collection.extend({model:expanz.models.data.Row})}),$(function(){window.expanz=window.expanz||{},window.expanz.models=window.expanz.models||{},window.expanz.models.data=window.expanz.models.data||{},window.expanz.models.data.Grid=Backbone.Model.extend({initialize:function(){this.rows=new expanz.models.data.RowCollection,this.hasActions=!1,this.rows.add([{id:"_header"},{id:"_actions"}])},clear:function(){var n=this;_.each(this.getAllRows(),function(t){n.rows.remove(t)}),this.removeColumns()},removeColumns:function(){var n=this;_.each(this.getAllColumns(),function(t){n.rows.get("_header").cells.remove(t)})},getColumn:function(n){return this.rows.get("_header").cells.get(n)},getAllColumns:function(){return this.rows.get("_header").cells.reject(function(n){return n.get("id")==="_header"},this)},getActions:function(){return this.rows.get("_actions").cells.reject(function(n){return n.get("id")==="_actions"},this)},getAction:function(n){return this.rows.get("_actions").cells.reject(function(t){return t.get("id")==="_actions"||t.get("actionName")!=n},this)},addAction:function(n,t,i,r,u,f){this.hasActions=!0,this.rows.get("_actions").cells.add({id:t,type:n,label:i,width:r,actionName:u,actionParams:f})},addColumn:function(n,t,i,r,u){this.rows.get("_header").cells.add({id:n,field:t,label:i,datatype:r,width:u})},getAllRows:function(){return this.rows.reject(function(n){return n.id==="_header"||n.id==="_actions"||this.id===n.id||this.activityId===n.id},this)},sortRows:function(n,t){this.rows.comparator=function(t){var i=t.getCellsMapByField().sortedValues[n]||"";return i.toLowerCase()},this.rows.sort(),t||this.rows.models.reverse()},addRow:function(n,t,i){this.rows.add({id:n,type:t,displayStyle:i,gridId:this.id})},addCell:function(n,t,i,r,u){this.rows.get(n).cells.add({id:t,value:i,field:r,sortValue:u})},updateRowSelected:function(n,t){window.expanz.logToConsole("GridModel:updateRowSelected id:"+n+" ,type:"+t)},updateRowDoubleClicked:function(n,t){window.expanz.logToConsole("GridModel:updateRowDoubleClicked id:"+n+" ,type:"+t)},actionSelected:function(n,t,i){window.expanz.logToConsole("GridModel:actionSelected id:"+n+" ,methodName:"+t+" ,methodParams:"+JSON.stringify(i))},menuActionSelected:function(n,t,i){window.expanz.logToConsole("GridModel:menuActionSelected id:"+n+" ,menuActionName:"+t+" , menuActionParams:"+JSON.stringify(i))},contextMenuSelected:function(n,t,i,r){window.expanz.logToConsole("GridModel:contextMenuSelected type:"+t+" ,id:"+n+" ,contextObject:"+i+" , contextMenuParams:"+JSON.stringify(r))},refresh:function(){expanz.net.DataRefreshRequest(this.id,this.parent)}})});
/*!
////////////////////////////////////////////////////////////////////////////////
//
//  EXPANZ
//  Usage: http://expanz.com/docs/client-technologies/javascript-sdk/
//  Author: Kim Damevin, Chris Anderson
//  Copyright 2008-2012 EXPANZ
//  All Rights Reserved.
//
//  NOTICE: expanz permits you to use, modify, and distribute this file
//  in accordance with the terms of the license agreement accompanying it.
//
////////////////////////////////////////////////////////////////////////////////
 */
$(function(){function i(n){var t="";return config._URLprefix.endsWith("/")||(t="/"),config._URLprefix+t+n}window.expanz=window.expanz||{},window.expanz.clientVersion="1.0",window.expanz.helper=window.expanz.helper||{},window.expanz.net={lastRequest:"",lastResponse:"",CreateSessionRequest:function(t,i,r){expanz.Storage.clearSession();var u=config._AppSite,f=config._AuthenticationMode;n(requestBuilder.CreateSession(t,i,u,f),parseCreateSessionResponse(r))},WebServerPing:function(t){t===undefined&&(t=3),window.expanz.pingError===undefined&&(window.expanz.pingError=0),n(requestBuilder.WebServerPing(),function(n){var i=$(n).find("WebServerPingResult");i.length>0&&i.text()=="true"?(window.expanz.pingError=0,window.expanz.Storage.setPingSuccess(),window.expanz.logToConsole("WEB SERVER PING OK")):(window.expanz.pingError++,window.expanz.pingError===t?expanz.views.redirect(window.expanz.getMaintenancePage()):window.expanz.net.WebServerPing(t))})},GetSessionDataRequest:function(t){if(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}n(requestBuilder.GetSessionData(expanz.Storage.getSessionHandle()),parseGetSessionDataResponse(t))},CreateActivityRequest:function(t,i){if(i===undefined&&(i=t.callbacks),t.get("allowAnonymous")===!1&&(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()==="")){expanz.views.requestLogin();return}if(expanz.Storage.getSessionHandle()&&expanz.Storage.getSessionHandle()!==""){var u=null,r=expanz.Storage.getActivityHandle(t.get("name"),t.get("style"));r!==undefined&&r!==null?t.set({handle:r}):u={type:"CreateActivity",activityModel:t},t.set({loading:!0}),n(requestBuilder.CreateActivity(t,expanz.Storage.getSessionHandle()),parseResponse(t,u,i))}},GetSavePreferencesRequest:function(t,i,r,u){if(t.get("allowAnonymous")===!1&&(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()==="")){expanz.views.requestLogin();return}u===!0&&window.expanz.Storage.setUserPreference(i,r),t.isAnonymous()||n(requestBuilder.GetSavePreferences(i,r,expanz.Storage.getSessionHandle()))},DeltaRequest:function(t,i,r,u){if(u===undefined&&(u=r.callbacks),r.get("allowAnonymous")===!1&&(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()==="")){expanz.views.requestLogin();return}var f={type:"field",id:t};r.set({deltaLoading:{isLoading:!0,initiator:f}}),n(requestBuilder.Delta(t,i,r,expanz.Storage.getSessionHandle()),parseResponse(r,f,u),null,!0)},MethodRequest:function(t,i,r,u,f,e){if(e===undefined&&(e=u.callbacks),u.get("allowAnonymous")===!1&&(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()==="")){expanz.views.requestLogin();return}var o={type:"method",id:t};u.set({deltaLoading:{isLoading:!0,initiator:o}}),u.isAnonymous()?n(requestBuilder.AnonymousMethod(t,i,r,u,f),parseResponse(u,o,e),null,!0):n(requestBuilder.Method(t,i,r,u,expanz.Storage.getSessionHandle()),parseResponse(u,o,e),null,!0)},AnonymousMethodsRequest:function(t,i,r){r===undefined&&(r=i.callbacks);var u={type:"anonymous",id:"anonymous"};i.set({deltaLoading:{isLoading:!0,initiator:u}}),n(requestBuilder.AnonymousMethods(t,i),parseResponse(i,u,r),null,!0)},CloseActivityRequest:function(t,i){if(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}n(requestBuilder.CloseActivity(t,expanz.Storage.getSessionHandle()),parseCloseActivityResponse(i))},DataRefreshRequest:function(t,i,r){if(r===undefined&&(r=i.callbacks),!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}var u={type:"resfresh",id:t};i.set({deltaLoading:{isLoading:!0,initiator:u}}),n(requestBuilder.DataRefresh(t,i,expanz.Storage.getSessionHandle()),parseResponse(i,u,r),null,!0)},ReleaseSessionRequest:function(t){if(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}n(requestBuilder.ReleaseSession(expanz.Storage.getSessionHandle()),parseReleaseSessionResponse(t))},GetBlobRequest:function(n,t,i){if(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}t.set({deltaLoading:{isLoading:!1,initiator:i}}),r(requestBuilder.GetBlob(n,t,expanz.Storage.getSessionHandle()))},GetFileRequest:function(n,t,i){if(!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}t.set({deltaLoading:{isLoading:!1,initiator:i}}),r(requestBuilder.GetFile(n,t,expanz.Storage.getSessionHandle()))},CreateMenuActionRequest:function(t,i,r,u,f,e,o){if(o===undefined&&(o=t.callbacks),!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}var s={type:"menuaction",id:i};t.set({deltaLoading:{isLoading:!0,initiator:s}}),n(requestBuilder.CreateMenuAction(t,i,r,u,f,e,expanz.Storage.getSessionHandle()),parseResponse(t,s,o),null,!0)},CreateContextMenuRequest:function(t,i,r,u,f){if(f===undefined&&(f=t.callbacks),!expanz.Storage.getSessionHandle()||expanz.Storage.getSessionHandle()===""){expanz.views.requestLogin();return}var e={type:"contextmenu",id:i};t.set({deltaLoading:{isLoading:!0,initiator:e}}),n(requestBuilder.CreateContextMenuAction(t,i,r,u,expanz.Storage.getSessionHandle()),parseResponse(t,e,f),null,!0)},CreateAnonymousRequest:function(t,i){i===undefined&&(i=window.expanz.defaultCallbacks),n(requestBuilder.CreateAnonymousRequest(t),parseExecAnonymousResponse(i))}};var t,u=[],n=function(n,r,f){!1&&t&&u.push([n,r,f]),window.expanz.logToConsole("REQUEST:"),window.expanz.logToConsole(n.data),t=!0,window.expanz.net.lastRequest=n.data;$(window.expanz.html.busyIndicator()).trigger("isBusy"),$.ajaxSetup({headers:{"cache-control":"no-cache"}}),config._URLproxy!==undefined&&config._URLproxy.length>0?$.ajax({type:"POST",url:config._URLproxy,data:{url:i(n.url),data:n.data,method:n.method||"POST"},dataType:"XML",processData:!0,async:!0,complete:function(n){if(t=!1,window.expanz.net.lastResponse=n.responseText,$(window.expanz.html.busyIndicator()).trigger("notBusy"),window.expanz.logToConsole("RESPONSE:"),window.expanz.logToConsole(n.responseText),n.status!=200)eval(r)("There was a problem with the last request.");else if(f!==undefined&&f===!0){var i=window.open("","newwin","width=400,height=500");i.document.open(),i.document.write(n.responseText),i.document.close()}else r&&eval(r)(n.responseXML)}}):$.ajax({type:n.method||"POST",url:i(n.url),data:n.data,dataType:"XML",processData:!0,complete:function(n){if(n.status!=200)eval(r)("There was a problem with the last request.");else if(f!==undefined&&f===!0){var t=window.open("","newwin","width=400,height=500");t.document.open(),t.document.write(n.responseText),t.document.close()}else r&&eval(r)(n.responseXML)}})},r=function(n){$("#formFile")&&$("#formFile").remove();var t="";t+="<form method='post' id='formFile' target='_blank' action='"+config._URLproxy+"'>",t+="<input type='hidden' name='url' value='"+i(n.url)+"'>",t+="<input type='hidden' name='data' value='"+n.data+"'>",t+="<\/form>",$("body").append(t),$("#formFile").submit()}});var XMLNamespace=window.config._XMLNamespace||XMLNamespace,requestBuilder={CreateSession:function(n,t,i,r){return{data:this.buildRequest("CreateSessionX",XMLNamespace)(requestBody.createSession(n,t,i,r)),url:"CreateSessionX"}},Ping:function(){return{data:this.buildRequest("Ping",XMLNamespace)(""),url:"Ping"}},WebServerPing:function(){return{data:"",url:"WebServerPing",method:"GET"}},GetSessionData:function(n){return{data:this.buildRequest("ExecX",XMLNamespace,n)(requestBody.getSessionData()),url:"ExecX"}},GetSavePreferences:function(n,t,i){return{data:this.buildRequest("ExecX",XMLNamespace,i)(requestBody.createSavePreferences(n,t)),url:"ExecX"}},CreateActivity:function(n,t){return{data:this.buildRequest("ExecX",XMLNamespace,t)(requestBody.createActivity(n)),url:"ExecX"}},Delta:function(n,t,i,r){return{data:this.buildRequest("ExecX",XMLNamespace,r)(requestBody.delta(n,t,i)),url:"ExecX"}},Method:function(n,t,i,r,u){return{data:this.buildRequest("ExecX",XMLNamespace,u)(requestBody.createMethod(n,t,i,r)),url:"ExecX"}},AnonymousMethod:function(n,t,i,r,u){return{data:this.buildRequest("ExecAnonymousX",XMLNamespace,null,!0)(requestBody.createMethod(n,t,i,r,u)),url:"ExecAnonymousX"}},AnonymousMethods:function(n,t){return{data:this.buildRequest("ExecAnonymousX",XMLNamespace,null,!0)(requestBody.createAnonymousMethods(n,t)),url:"ExecAnonymousX"}},CloseActivity:function(n,t){return{data:this.buildRequest("ExecX",XMLNamespace,t)(requestBody.closeActivity(n)),url:"ExecX"}},ReleaseSession:function(n){return{data:this.buildRequest("ReleaseSession",XMLNamespace,n)(requestBody.createReleaseSession()),url:"ReleaseSession"}},GetBlob:function(n,t,i){return{data:this.buildRequestWithoutESA("GetBlob",XMLNamespace,i)(requestBody.getBlob(n,t)),url:"GetBlob"}},GetFile:function(n,t,i){return{data:this.buildRequestWithoutESA("GetFile",XMLNamespace,i)(requestBody.getFile(n,t)),url:"GetFile"}},DataRefresh:function(n,t,i){return{data:this.buildRequest("ExecX",XMLNamespace,i)(requestBody.dataRefresh(n,t)),url:"ExecX"}},CreateMenuAction:function(n,t,i,r,u,f,e){return{data:this.buildRequest("ExecX",XMLNamespace,e)(requestBody.createMenuAction(n,t,i,r,u,f)),url:"ExecX"}},CreateContextMenuAction:function(n,t,i,r,u){return{data:this.buildRequest("ExecX",XMLNamespace,u)(requestBody.createContextMenuAction(n,t,i,r)),url:"ExecX"}},CreateAnonymousRequest:function(n){return{data:this.buildRequest("ExecAnonymousX",XMLNamespace,null,!0)(n),url:"ExecAnonymousX"}},buildRequest:function(n,t,i,r){return function(u){var e=r?"<site>"+config._AppSite+"<\/site>":"",o=t?' xmlns="'+t+'" ':"",s="<"+n+o+">"+e+"<xml><ESA>",f="<\/ESA><\/xml>";return f+=i?"<sessionHandle>"+i+"<\/sessionHandle>":"",f+="<\/"+n+">",s+u+f}},buildRequestWithoutESA:function(n,t,i){return function(r){var f="<"+n+' xmlns="'+t+'">',u;return f+=i?"<sessionHandle>"+i+"<\/sessionHandle>":"",u="",u+="<\/"+n+">",f+r+u}}},requestBody={createSession:function(n,t,i,r){return r===undefined&&(r="Primary"),'<CreateSession source="MixiLink" user="'+n+'" password="'+t+'" appSite="'+i+'" authenticationMode="'+r+'" clientType="HTML" clientVersion="'+window.expanz.clientVersion+'" schemaVersion="2.0"/>'},getSessionData:function(){return"<GetSessionData/>"},createSavePreferences:function(n,t){return'<SavePreferences><UserPreference key="'+n+'" value="'+t+'" /><\/SavePreferences>'},createActivity:function(n){var i=n.get("handle"),t="",r="";return n.get("optimisation")===!0&&n.fields.forEach(function(n){r+='<Field id="'+n.get("fieldId")+'" masked="0" />'}),t="",i?(n.get("optimisation")===!0&&(t+=this.wrapPayloadInActivityRequest(r,n)),t+='<PublishSchema activityHandle="'+i+'"> '):(t+="<CreateActivity ",t+='name="'+n.get("name")+'"',t+=n.get("style")?' style="'+n.get("style")+'"':"",t+=n.get("optimisation")?' suppressFields="1"':"",t+=n.get("key")?' initialKey="'+n.get("key")+'">':">",n.get("optimisation")===!0&&(t+=r)),t+=this.getActivityDataPublicationRequests(n),t+(i?"<\/PublishSchema>":"<\/CreateActivity>")},delta:function(n,t,i){return this.wrapPayloadInActivityRequest('<Delta id="'+n+'" value="'+t+'"/>',i)},createMethod:function(n,t,i,r,u){var f="";return r.isAnonymous()&&(f+=this.getActivityDataPublicationRequests(r)),i!==null&&i.id&&(f+='<Context contextObject="'+i.contextObject+'" id="'+i.id+'" type="'+i.type+'" />'),f+='<Method name="'+n+'"',t!==undefined&&t.length>0&&_.each(t,function(n){n.value!==undefined&&(f+=" "+n.name+"='"+n.value+"' ")}),r.isAnonymous()&&(f+=" company='"+config._anonymousCompanyCode+"' "),f+=">",r.isAnonymous()&&u&&u.length>0&&_.each(u,function(n){f+="<"+n.id+">"+n.value+"<\/"+n.id+">"}),f+="<\/Method>",this.wrapPayloadInActivityRequest(f,r)},createAnonymousMethods:function(n,t){var i=this.getActivityDataPublicationRequests(t);return $.each(n,function(n,t){i+='<Method name="'+t.name+'"',i+=" contextObject='"+t.contextObject+"' ",i+=" company='"+config._anonymousCompanyCode+"' ",i+=">",t.additionalElement&&(i+=t.additionalElement),i+="<\/Method>"}),this.wrapPayloadInActivityRequest(i,t)},createMenuAction:function(n,t,i,r,u,f){var e="",o=i?' contextObject="'+i+'"':"";return t&&(e+='<Context id="'+t+'"'+o,e+=f?" setIdFromContext='1' ":"",e+="/>"),e+="<MenuAction ",e+=r?' action="'+r+'" ':' defaultAction="'+u+'" ',e+=o+"/>",this.wrapPayloadInActivityRequest(e,n)},createContextMenuAction:function(n,t,i,r){var u="",f=r?' contextObject="'+r+'"':"",e=i?i:r;return t&&(u+='<Context id="'+t+'"'+f,u+=e?" Type='"+e+"' ":"",u+="/>"),u+="<ContextMenu ",u+=f+"/>",this.wrapPayloadInActivityRequest(u,n)},closeActivity:function(n){return'<Close activityHandle="'+n+'"/>'},createReleaseSession:function(){return"<ReleaseSession/>"},getBlob:function(n,t){return"<activityHandle>"+t.get("handle")+"<\/activityHandle><blobId>"+n+"<\/blobId><isbyteArray>false<\/isbyteArray>"},getFile:function(n,t){return"<activityHandle>"+t.get("handle")+"<\/activityHandle><fileName>"+n+"<\/fileName><isbyteArray>false<\/isbyteArray>"},dataRefresh:function(n,t){return"<activityHandle>"+t.get("handle")+'<\/activityHandle><DataPublication id="'+n+'" refresh="1" />'},wrapPayloadInActivityRequest:function(n,t){return t.isAnonymous()?'<Activity id="'+t.get("name")+'">'+n+"<\/Activity>":'<Activity activityHandle="'+t.get("handle")+'">'+n+"<\/Activity>"},getActivityDataPublicationRequests:function(n){var t="";return n.dataPublications.each(function(n){var i=n.get("populateMethod")?' populateMethod="'+n.get("populateMethod")+'"':"",r=n.get("query")?' query="'+n.get("query")+'"':"",u=n.get("autoPopulate")?' autoPopulate="'+n.get("autoPopulate")+'"':"",f=n.get("type")?' type="'+n.get("type")+'"':"";t+='<DataPublication id="'+n.get("dataId")+'"'+r+i+u+f,t+=n.get("contextObject")?' contextObject="'+n.get("contextObject")+'"':"",t+="/>"}),t}},parseCreateSessionResponse=function(n){return function(t){if($(t).find("CreateSessionXResult").length>0)expanz.Storage.setSessionHandle($(t).find("CreateSessionXResult").text());else{n&&n.error&&n.error("Server session error. We are unable to log you in at this time."),window.expanz.logToConsole("Error: Server did not provide a sessionhandle. Unable to login. "+t);return}if(expanz.Storage.getSessionHandle()&&expanz.Storage.getSessionHandle().length!==0)n&&n.success&&n.success();else{var i="";if($(t).find("errorMessage").each(function(){i=$(this).text()}),i.length>0){n&&n.error&&n.error(i),window.expanz.logToConsole(i);return}}return}};$(function(){window.expanz=window.expanz||{},window.expanz.Storage={_getBestStorage:function(){if(window.localStorage!==null&&window.localStorage){var n=window.localStorage.length;return n=n,this.localStorage}return this.cookies},_getStorageGlobalName:function(){var n=config._siteCountry===undefined?"":"_"+config._siteCountry,t=config._siteEnvironment===undefined?"":"_"+config._siteEnvironment;return"_expanz_"+config._AppSite+n+t+"_"},getSessionHandle:function(){var n=this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"session.handle");return n=="undefined"?undefined:n},setSessionHandle:function(n){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"session.handle",n),!0},getActivityHandle:function(n,t){var i=this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"activity.handle."+n+t);return i===undefined||i===null?undefined:(i&&(i=i.replace("_",".")),i)},setActivityHandle:function(n,t,i){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"activity.handle."+t+i,n.replace(".","_")),!0},getProcessAreaList:function(){return typeof this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"processarea.list")=="object"?this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"processarea.list"):JSON.parse(this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"processarea.list"))},setProcessAreaList:function(n){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"processarea.list",JSON.stringify(n)),!0},getUserDetailsList:function(){return JSON.parse(this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"userDetails.list"))},setUserDetails:function(n){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"userDetails.list",JSON.stringify(n)),!0},setRolesList:function(n){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"roles.list",JSON.stringify(n)),!0},hasRole:function(n){var t=JSON.parse(this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"roles.list"));return t!==null?t[n]!==undefined:!1},setDashboards:function(n){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"dashboards",JSON.stringify(n)),!0},getDashboardFieldValue:function(n,t){var i=JSON.parse(this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"dashboards"));return i!==null&&i[n]!==null?i[n][t]:null},getLastPingSuccess:function(){return this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"lastPingSuccess")},setPingSuccess:function(){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"lastPingSuccess",(new Date).getTime()),!0},getLastURL:function(){return this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"lastURL")},setLastURL:function(n){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"lastURL",n),!0},clearLastURL:function(){return this._getBestStorage().remove(expanz.Storage._getStorageGlobalName()+"lastURL"),!0},setUserPreference:function(n,t){return this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"UserPreference"+n,t),!0},getUserPreference:function(n){return this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"UserPreference"+n)},setFormMapping:function(n){return this._formMappingData=n,this._getBestStorage().set(expanz.Storage._getStorageGlobalName()+"FormMapping",serializeXML(n)),!0},getFormMapping:function(){if(this._formMappingData===undefined){var n=this._getBestStorage().get(expanz.Storage._getStorageGlobalName()+"FormMapping");n!=null&&(this._formMappingData=$.parseXML(n))}return this._formMappingData},clearSession:function(){var n=this._getBestStorage(),t=expanz.Storage._getStorageGlobalName();return n.remove(t+"session.handle"),n.remove(t+"lastPingSuccess"),n.remove(t+"roles.list"),n.remove(t+"dashboards"),this.clearActivityHandles(),!0},clearActivityHandles:function(){var n=this._getBestStorage(),t=n.getKeys(expanz.Storage._getStorageGlobalName()+"activity.handle");_.each(t,function(t){n.remove(t)})},clearActivityHandle:function(n,t){var i=this.getActivityHandle(n,t);return i!==undefined&&i!==null&&this._getBestStorage().remove(expanz.Storage._getStorageGlobalName()+"activity.handle."+n+t),i},cookies:{name:"cookie",set:function(n,t){$.cookies.set(n,t)},get:function(n){return $.cookies.get(n)},getKeys:function(n){var t=[];return _.each($.cookies.filter(n),function(n,i){t.push(i)}),t},remove:function(n){$.cookies.del(n)}},localStorage:{name:"localStorage",set:function(n,t){window.localStorage.setItem(n,t)},get:function(n){return window.localStorage.getItem(n)},getKeys:function(n){var t=[];for(i=0;i<window.localStorage.length;i++)key=window.localStorage.key(i),n?key.indexOf(n)>=0&&t.push(key):t.push(key);return t},remove:function(n){return window.localStorage.removeItem(n)}},sessionStorage:{name:"sessionStorage",set:function(n,t){window.sessionStorage.setItem(n,t)},get:function(n){return window.sessionStorage.getItem(n)},getKeys:function(n){var t=[];for(i=0;i<window.sessionStorage.length;i++)key=window.sessionStorage.key(i),n?key.indexOf(n)>=0&&t.push(key):t.push(key);return t},remove:function(n){return window.sessionStorage.removeItem(n)}}}}),$(function(){window.expanz=window.expanz||{},window.expanz.menu=window.expanz.menu||{},window.expanz.menu.AppSiteMenu=function(){this.processAreas=[],this.load=function(n,t,i){var o,r,u,f,e;if(n.html(""),n.attr("type")=="icon")t>0&&(n.append('<div id="backOneLevel" class="icon"><img src="assets/images/home.png">Back<\/div>'),n.find("#backOneLevel").click(function(){var r=new expanz.Storage.AppSiteMenu;r.processAreas=i,r.load(n.closest("[bind=menu]"),t-1)})),o=this,_.each(this.processAreas,function(t){t.load(n,0,!0,o.processAreas)});else{r=window.location.href,u=r.substring(r.lastIndexOf("/")+1),window.config._homepage&&u.length==0&&(u=getPageUrl(window.config._homepage)),n.append('<ul id="menuUL" class="menu"><\/ul>');var s=n.attr("homeLabel")||"Home",h=n.attr("logoutLabel")||"Logout",c=n.attr("backLabel")||"Back";window.config._backButton===!0&&n.find("#menuUL").before('<a href="javascript:void(0);" onclick="history.go(-1);return true;" class="backbutton">'+c+"<\/a>"),window.config._homepage&&(f="",r=getPageUrl($(this).attr("form")),e=getPageUrl(window.config._homepage),e==u&&(f="selected selectedNew "),n.find("#menuUL").append('<li class="'+f+' processarea menuitem" id="home"><a href="'+e+'" class="home menuTitle">'+s+"<\/a><\/li>")),_.each(this.processAreas,function(t){var i="";t.title.indexOf("[CR]")!=-1&&(i="small"),t.title=t.title.replace("[CR]","<br />"),n.find("#menuUL").append('<li class="processarea menuitem '+i+'" id="'+t.id+'"><a class="menuTitle" href="#">'+t.title+"<\/a><\/li>"),t.load(n.find("#"+t.id+".processarea.menuitem"),0,!1)}),n.append('<ul class="right logoutContainer"><li class="processarea" id="logout"><a class="logout menuTitle">'+h+"<\/a><\/li><\/ul>"),n.append('<div style="clear:both"><\/div>'),$(n.find("#logout")[0]).click(function(){expanz.security.logout()})}}}}),$(function(){window.expanz=window.expanz||{},window.expanz.menu=window.expanz.menu||{},window.expanz.menu.ProcessAreaMenu=function(n,t){this.id=n,this.title=t,this.activities=[],this.pa=[],this.load=function(n,t,i,r){var f=window.location.href,s=f.substring(f.lastIndexOf("/")+1),o,u,e;i===!0?(_.each(this.activities,function(t){t.load(n,!0)}),this.pa&&this.pa.length>0&&(e=0,o=(new Date).getTime(),_.each(this.pa,function(i){var u="subprocess"+o+"_"+e++;n.append('<div id="'+u+'" class="icon"><img src="'+i.img+'"/><br/> '+i.title+"<\/div>"),n.find("#"+u).click(function(){var u=new expanz.Storage.AppSiteMenu;u.processAreas=[i],u.load(n.closest("[bind=menu]"),t+1,r)})}))):(u=this.id+"_"+t,this.activities.length>0&&(this.activities.length==1?(f=this.activities[0].url,n.find("[class='menuTitle']").attr("href",f),n.find("[class='menuTitle']").bind("touchend",function(){window.location.href=f}),f==s&&n.addClass("selected selectedNew")):(n.append('<ul style="display:none" id="'+u+'"><\/ul>'),n.click(function(){}),_.each(this.activities,function(t){t.load(n.find("#"+u),!1)}))),this.pa&&this.pa.length>0&&(n.find("#"+u).length===0&&n.append('<ul style="display:none" id="'+u+'"><\/ul>'),e=0,_.each(this.pa,function(i){var r=u+"_li_"+e++;i.id===undefined&&(i.id=r),n.find("#"+u).append('<li class="processarea menuitem" id="'+r+'"><a class="menuTitle" href="#">'+i.title+"<\/a><\/li>"),i.load(n.find("#"+r+".processarea.menuitem"),t+1)})))}}}),$(function(){window.expanz=window.expanz||{},window.expanz.menu=window.expanz.menu||{},window.expanz.menu.ActivityMenu=function(n,t,i,r,u){this.name=n,this.style=t,this.title=i,this.url=r,this.img=u,this.load=function(n,t){this.title=this.title.replace("[CR]","<br />"),t===!0?n.append('<li><div class="icon navContainer"><a class="nav-'+this.name.replace(/\./g,"-")+"-"+this.style.replace(/\./g,"-")+' navItem" href="'+this.url+'"><\/a><a class="navText" href="'+this.url+'">'+this.title+"<\/a><\/div><\/li>"):n.append('<li class="activity"><a href=\''+this.url+"'>"+this.title+"<\/a><\/li>")}}}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.redirect=function(n){window.location.href=getPageUrl(n)},window.expanz.views.requestLogin=function(){window.expanz.Storage.setLastURL(document.URL),window.expanz.views.redirect(expanz.security.getLoginPage())},window.expanz.views.updateViewElement=function(n,t,i,r,u){var f=$(t),l=i.datatype,h,o,e,s,c,a;if(l&&l.toLowerCase()==="blob"&&r&&r==="value"){h=i.width,o='<img src="'+window.config._URLblobs+i.value+'"',o+=h?' width="'+h+'"':'width="100%"',o+="/>",f.html(o);return}if(e=i[r],s=f.attr("valueTransformFunction"),s!==undefined)try{e=eval(s)(e)}catch(v){window.expanz.logToConsole("Value could not be transformed with function (check function exists): "+s)}return i["null"]===!0&&(e=null),e!==undefined&&(c=jQuery.Event("valueUpdated"),r==="value"&&f.trigger(c,[e,u]),c.result===undefined&&(f.is("input")?(f.is(":checkbox")||f.is(":radio")?(f.addClass("checkbox"),a=f.attr("checkedValue")?f.attr("checkedValue"):1,e==a?f.prop("checked",!0):f.prop("checked",!1)):f.val(e),i.disabled===!0?(f.attr("disabled",!0),f.addClass("readonlyInput")):(f.removeAttr("disabled"),f.removeClass("readonlyInput"))):f.is("textarea")?f.val(e):f.html(e||"&nbsp;"))),t}}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.FieldView=Backbone.View.extend({initialize:function(){this.model.bind("change:label",this.modelUpdate("label"),this),this.model.bind("change:value",this.modelUpdate("value"),this),this.model.bind("change:text",this.modelUpdate("text"),this),this.model.bind("change:items",this.modelUpdate("value"),this),this.model.bind("change:date",this.modelUpdate("date"),this),this.model.bind("change:time",this.modelUpdate("time"),this),this.model.bind("change:DayOfWeek",this.modelUpdate("DayOfWeek"),this),this.model.bind("change:time24",this.modelUpdate("time24"),this),this.model.bind("change:timeAMPM",this.modelUpdate("timeAMPM"),this),this.model.bind("change:data",this.publishData,this),this.model.bind("change:disabled",this.onDisabledChanged,this),this.model.bind("change:hidden",this.onHiddenChanged,this),this.model.bind("change:errorMessage",this.displayError(),this),this.model.bind("change:loading",this.loading,this),this.model.bind("setFocus",this.setFocus,this)},modelUpdate:function(n){var t=this;return function(){var i=null;i=this.$el.attr("attribute")==="value"?this.$el:this.$el.find("[attribute="+n+"]"),expanz.views.updateViewElement(t,i,this.model.attributes,n,this.model),t.render(),this.$el.trigger("update:field")}},publishData:function(){this.$el.trigger("publishData",[this.model.get("data"),this])},onDisabledChanged:function(){this.model.get("disabled")===!0?(this.$el.attr("disabled",!0),this.$el.addClass("readonlyInput")):(this.$el.removeAttr("disabled"),this.$el.removeClass("readonlyInput"));var n=this.getInputElement();(n===undefined||n===null)&&(n=this.$el),n.trigger("disabledChanged",this.model.get("disabled"))},onHiddenChanged:function(){var n=!this.model.get("hidden");setVisibility(this.$el,n),this.$el.trigger("visibilityChanged",n)},displayError:function(){return function(){var t="error"+this.model.get("id").replace(/\./g,"_"),n;this.$el.attr("showError")!=="false"&&(this.model.get("errorMessage")!==undefined?(n=this.$el.find("#"+t),n.length<1&&(this.$el.append('<p class="errorMessage" id="'+t+'"><\/p>'),n=this.$el.find("#"+t)),n.html(this.model.get("errorMessage")),this.$el.addClass("errorField")):(n=this.$el.find("#"+t),n&&n.remove(),this.$el.removeClass("errorField"))),this.getInputElement().trigger("errorChanged",this.model.get("errorMessage"))}},events:{"change [attribute=value]":"viewUpdate"},getInputElement:function(){return this.$el.attr("attribute")==="value"?this.$el:this.$el.find("[attribute=value]")},getValue:function(){var n=this.getInputElement(),t=null,i,r;return $(n).is(":checkbox")?(i=$(n).attr("checkedValue")!==undefined?$(n).attr("checkedValue"):1,r=$(n).attr("uncheckedValue")!==undefined?$(n).attr("uncheckedValue"):0,t=$(n).prop("checked")?i:r):t=$(n).val(),t},viewUpdate:function(n){this.model.get("items")!==undefined&&this.model.get("items").length>0?this.model.update({value:(n.target.checked?1:-1)*n.target.value}):this.model.update({value:this.getValue()}),this.$el.trigger("update:field")},loading:function(){},setFocus:function(){var n=this.getInputElement();n!=undefined&&n!=null&&n.focus()}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.DataFieldView=window.expanz.views.FieldView.extend({initialize:function(n){this.dataModel=n.dataModel,this.model.bind("change:label",this.modelUpdate("label"),this),this.model.bind("change:value",this.valueChanged,this),this.model.bind("change:text",this.modelUpdate("text"),this),this.model.bind("change:items",this.modelUpdate("value"),this),this.model.bind("change:disabled",this.onDisabledChanged,this),this.model.bind("change:hidden",this.onHiddenChanged,this),this.model.bind("change:errorMessage",this.displayError(),this),this.model.bind("change:loading",this.loading,this),this.model.bind("setFocus",this.setFocus,this),this.dataModel.bind("change:xml",this.dataChanged,this)},valueChanged:function(){var n=this.getInputElement(),t=this.model.get("value");n.val(t),n.trigger("valueUpdated",[t,this.model])},dataChanged:function(){this.getInputElement().trigger("publishData",[this.dataModel.get("xml"),this]),this.valueChanged()}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.VariantFieldView=window.expanz.views.FieldView.extend({template:_.template("<input id='textinput' attribute='value' type='text' style='display: none' /> <label id='booleaninput' style='display: none'><input attribute='value' type='checkbox' /> Yes / I Agree<\/label><div id='options' style='display: none' />"),initialize:function(){this.model.bind("change:label",this.modelUpdate("label"),this),this.model.bind("change:value",this.valueChanged(),this),this.model.bind("change:data",this.dataChanged(),this),this.model.bind("change:visualType",this.visualTypeChanged(),this),this.model.bind("change:disabled",this.onDisabledChanged,this),this.model.bind("change:hidden",this.onHiddenChanged,this),this.model.bind("change:errorMessage",this.displayError(),this),this.model.bind("change:loading",this.loading,this),this.$el.html(this.template({name:this.$el.attr("name")})),this.textInput=this.$el.find("[id=textinput]"),this.booleanControl=this.$el.find("[id=booleaninput]"),this.booleanInput=this.booleanControl.find("[attribute=value]"),this.optionInput=this.$el.find("[id=options]")},visualTypeChanged:function(){var n=this;return function(){n.render(),this.$el.trigger("update:field")}},valueChanged:function(){var n=this;return function(){this.updateActiveInputValue(this.model.get("value"))}},dataChanged:function(){var n=this;return function(){this.optionInput.html("");var t=_.template("<div><label><input id='<%= id %>' name='<%= group %>' value='<%= rowId %>' attribute='value' type='radio' /> <%= label %><\/label><\/div>"),i=this.model.get("data");_.each(i.find("Row"),function(i){var u=n.$el.attr("name"),r=$(i).attr("id"),f=$(i).find("Cell"),e=$(f).text(),o=n.model.id.replace(/\./g,"_")+"_"+r;n.optionInput.append(t({id:o,rowId:r,label:e,group:u}))}),this.updateActiveInputValue(this.model.get("value")),this.$el.trigger("update:field")}},render:function(){this.textInput.hide(),this.booleanControl.hide(),this.optionInput.hide();var n=this.activeInputField();return n!=null&&(this.updateActiveInputValue(this.model.get("value")),this.activeInputControl().show()),this},getValue:function(){var n=null,t=this.model.get("visualType"),i;return t=="cb"?n=boolString(this.booleanInput.prop("checked")):t=="rb"?(i=this.optionInput.find(":checked"),n=i.val()):t=="txt"&&(n=this.textInput.val()),n},activeInputControl:function(){var t=this.model.get("visualType"),n=null;return t=="cb"?n=this.booleanControl:t=="rb"?n=this.optionInput:t=="txt"&&(n=this.textInput),n},activeInputField:function(){var n=this.model.get("visualType");return n=="cb"?this.booleanInput:this.activeInputControl()},updateActiveInputValue:function(n){var t=this.model.get("visualType"),i;t=="cb"?this.booleanInput.prop("checked",n==1):t=="rb"?(i=this.optionInput.find("[value="+n+"]"),i.prop("checked",!0)):t=="txt"&&this.textInput.val(n)}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.DependantFieldView=Backbone.View.extend({initialize:function(){this.model.bind("change:value",this.toggle,this),this.$el.hide()},toggle:function(){var n=this.$el.find("[attribute=value]");expanz.views.updateViewElement(this,n,this.model.get("value")),this.model.get("value").length>0?this.$el.show("slow"):this.$el.hide("slow")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.MethodView=Backbone.View.extend({initialize:function(){this.model.bind("change:label",this.labelChanged(),this),this.model.bind("change:loading",this.loading,this),this.model.bind("contextMenuLoaded",this.onContextMenuLoaded,this)},events:{"click [attribute=submit]":"submit"},submit:function(){this.model.submit(),this.$el.trigger("submit:"+this.model.get("id"))},labelChanged:function(){return function(){this.getButton().text(this.model.get("label"))}},loading:function(){this.model.get("loading")===!0?(this.getButton().attr("disabled","disabled"),this.$el.addClass("methodLoading")):(this.getButton().removeAttr("disabled"),this.$el.removeClass("methodLoading"))},getButton:function(){var n=this.$el,t,i,r;return this.$el.is(":button")?n=this.$el:(t=this.$el.find("button"),t.length!=0?n=t:(i=this.$el.find("a"),i.length!=0&&(r=this.$el.find("span"),n=r.length!=0?r:i))),n},onContextMenuLoaded:function(){if(this.model.contextMenuModel.length!==0){var n=new expanz.views.ContextMenuView({el:this.el,id:this.model.id,collection:this.model.contextMenuModel});n.render()}}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.MessagesView=Backbone.View.extend({tagName:"ul",className:"notificationArea",initialize:function(){this.collection.bind("add",this.messageAdded,this),this.collection.bind("remove",this.messageRemoved,this),this.collection.bind("reset",this.collectionReset,this)},messageAdded:function(n){var i=new window.expanz.views.MessageItemView({model:n}),u=this.$el,t=i.$el,r;u.append(i.render().el),t.show(),r=!0,t.slideDown(100,function(){r&&t.delay(5e3).slideUp(800,function(){t.remove()})}),t.length>0&&setTimeout(function(){t.remove()},5e3)},messageRemoved:function(){},collectionReset:function(){this.$el.html("")}}),window.expanz.views.MessageItemView=Backbone.View.extend({tagName:"li",render:function(){switch(this.model.get("type").toLowerCase()){case"fatal":case"error":case"warning":this.el.className="error";break;case"info":case"success":this.el.className="info";break;default:this.el.className="info"}return this.$el.html(this.model.get("message")),this}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.ContextMenuView=Backbone.View.extend({initialize:function(){this.collection.bind("menuLoaded",this.render,this)},render:function(){var n,t,r,i;this.collection.length!==0&&(this.contextMenuEl===undefined&&(n=this.collection.id.replace(/\./g,"_")+"_contextMenu",this.$el.append("<div class='contextMenu' id='"+n+"' />"),this.contextMenuEl=this.$el.find("#"+n)),n===undefined&&(n=this.contextMenuEl.id||this.contextMenuEl[0].id),this.contextMenuEl.hide(),this.contextMenuEl.html(""),t=0,r=0,this.$el.find("button").length>0?(t=this.$el.find("button").position(),r=t.top+this.$el.find("button").outerHeight()+2):(t=this.$el.find("span").position(),r=t.top+this.$el.find("span").outerHeight()+2),this.contextMenuEl.css({position:"absolute",top:r+"px",left:t.left+10+"px",zIndex:9999}),this.contextMenuEl.append("<ul id='"+n+"_ul'><\/ul>"),this.appendMenuItems(this.contextMenuEl.find("ul")),this.createContextMenu(),i=this,this.mouseInside=!1,this.contextMenuEl.hover(function(){i.mouseInside=!0},function(){i.mouseInside=!1}),$("body").bind("mouseup."+i.contextMenuEl.selector,function(){i.mouseInside||(i.contextMenuEl.remove(),$("body").unbind("mouseup."+n))}))},appendMenuItems:function(n){var t=this,i=0;this.collection.forEach(function(r){var f=(n.id||n[0].id)+"_li_"+i++,u;n.append("<li id='"+f+"' action='"+r.get("action")+"' class=' "+(r.get("isDefaultAction")?"defaultAction":"")+" '>"+r.get("text")+"<\/li>"),u=n.find("#"+f),u.unbind("click"),u.click(function(n){n||(n=window.event),n.stopPropagation?n.stopPropagation():n.cancelBubble=!0,r.menuItemSelected(r.get("action")),t.contextMenuEl.remove()})})},createContextMenu:function(){this.contextMenuEl.show()},destroyView:function(){this.undelegateEvents(),$(this.contextMenuEl).removeData().unbind(),this.contextMenuEl.remove(),Backbone.View.prototype.remove.call(this)}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.GridView=Backbone.View.extend({initialize:function(){this.model.bind("update:grid",this.render,this),this.bind("rowClicked",this.rowClicked,this),this.bind("rowDoubleClicked",this.rowDoubleClicked,this),this.bind("actionClicked",this.actionClicked,this),this.bind("menuActionClicked",this.menuActionClicked,this),this.bind("contextMenuClicked",this.contextMenuClicked,this)},rowClicked:function(n){n.attr("id")!=this.selectedId&&(this.selectedId=n.attr("id"),this.model.updateRowSelected(this.selectedId,n.attr("type")))},rowDoubleClicked:function(n){this.model.updateRowDoubleClicked(n.attr("id"),n.attr("type"))},actionClicked:function(n,t,i,r){r.attr("disabled","disabled"),r.addClass("actionLoading"),this.model.actionSelected(n,t,i)},menuActionClicked:function(n,t,i){this.model.menuActionSelected(n,t,i)},contextMenuClicked:function(n,t,i,r){this.model.contextMenuSelected(n,t,i,r)},render:function(){var n=this.options.itemsPerPage;return(!n||n<=0)&&(n=1e3),this.renderWithPaging(0,n),this},renderWithPaging:function(n,t,i,r){var f=this.model.getAllRows(),e=parseInt(n*t,10),s=Math.min(e+parseInt(t,10),f.length),u,o=this.model.id+"_host";return u=this.itemTemplate()!==null?this.renderGridUsingItemTemplate(o,f,n,e,s,i,r):this.renderGridUsingDefaultLayout(o,f,e,s),this.renderPagingBar(n,t,u,i,r),$(u).attr("nbItems",f.length),this.model.renderingType=="popupGrid"?this.renderAsPopupGrid(o,u):this.model.renderingType=="rotatingBar"&&this.renderAsRotationBar(u,3,3,0),u.trigger("table:rendered"),this},renderGridUsingItemTemplate:function(n,t,i,r,u,f,e){var g=u>r,y=this.options.isHTMLTable=="true"?"table":"div",nt=this.options.enableConfiguration?boolValue(this.options.enableConfiguration):!1,tt=this.options.noItemText||"",it=this.options.nbItemsPerPageText||"Items per page",o=this.$el.find(y+"#"+n),b,l,p,k,a,d,c,s;if(o.length<1&&(this.$el.append("<"+y+' id="'+n+'"><\/'+y+">"),o=this.$el.find(y+"#"+n)),$(o).html(""),$(o).parent().find("#"+n+"_Configuration").remove(),g){if($(o).addClass("nonEmptyGrid"),$(o).removeClass("emptyGrid"),nt){for($(o).parent().prepend('<div id="'+n+'_Configuration"><\/div>'),b=$(o).parent().find("#"+n+"_Configuration"),l=[10,20,50,100],b.append('<div class="ItemsPerPage" >'+it+'<select id="'+n+'_Configuration_ItemsPerPage" name="ItemsPerPage">'),p=b.find("#"+n+"_Configuration_ItemsPerPage"),c=0;c<l.length;c++)k=itemsPerPage==l[c]?' selected="selected" ':"",p.append("<option "+k+' value="'+l[c]+'">'+l[c]+"<\/option>");p.append("<\/select><\/div>"),s=this,p.change(function(){s.renderWithPaging(i,$(this).val(),f,!e)})}for(this.headerTemplate()!=null&&(s=this,$(o).append(this.headerTemplate().html()),$(o).find("[sortField]").each(function(){var n=$(this).attr("sortField"),i=$(this).attr("defaultSorted");f===null&&i!==null&&(e=i.toLowerCase()=="desc"?!1:!0,f=n,s.model.sortRows(f,e),t=s.model.getAllRows()),$(this).addClass("sortable"),n==f&&(e?$(this).addClass("sortedAsc"):$(this).addClass("sortedDesc")),$(this).click(function(){var t=!0;n==f&&(t=!e),s.model.sortRows(n,t),s.renderWithPaging(0,itemsPerPage,n,t)})})),a=$(o),this.options.isHTMLTable!="true"&&($(o).append("<div class='gridItems'><\/div>"),a=$(o).find(".gridItems")),d=_.template(this.itemTemplate().html()),c=r;c<u;c++){var w=t[c],h=d(w.getCellsMapByField()),v=this.model.id+"_"+w.id;h=$(h).attr("id",v).attr("rowId",w.id),c===0&&(h=$(h).addClass("first")),c==u-1&&(h=$(h).addClass("last")),c%2==1?(h=$(h).addClass("alternate"),h=$(h).addClass("even")):h=$(h).addClass("odd"),$(h).find("[id*='userinput_']").each(function(){$(this).attr("id",w.id+"_"+$(this).attr("id"))}),a.append(h),s=this,a.find("#"+v+" [methodName] ").each(function(n,t){var i=s.model.getAction($(t).attr("methodName"));i&&i.length>0&&$(t).click(function(){var n=$(this).closest("[rowId]").attr("rowId"),t=i[0].get("actionParams").clone();s._handleActionClick($(this),n,i[0].get("actionName"),t,$(this).closest("[rowId]"))})}),a.find("#"+v+"  [autoUpdate] ").change(function(){var n=s.model.getAction($(this).attr("autoUpdate")),t,i;n&&n.length>0?(t=$(this).closest("[rowId]").attr("rowId"),i=n[0].get("actionParams").clone(),s._handleActionClick($(this),t,n[0].get("actionName"),i,$(this).closest("[rowId]"))):window.expanz.logToConsole("autUpdate action not defined in formapping: "+$(this).attr("autoUpdate"))}),o.find("#"+v+" [menuAction] ").each(function(n,t){var i=s.model.getAction($(t).attr("menuAction"));i&&i.length>0&&$(t).click(function(){var n=$(this).closest("[rowId]").attr("rowId"),t=i[0].get("actionParams").clone();s._handleMenuActionClick(n,i[0].get("actionName"),t,$(this).closest("[rowId]"))})}),o.find("#"+v+" [contextMenu] ").each(function(n,t){var i=s.model.getAction($(t).attr("contextMenu"));i&&i.length>0&&$(t).click(function(){var n=$(this).closest("[rowId]").attr("rowId"),u=i[0].get("actionParams").clone(),t,r;t=new expanz.models.ContextMenu({id:n,contextObject:i[0].get("actionName"),parent:s.model.parent}),r=new expanz.views.ContextMenuView({el:$(this),id:$(this).attr("id"),className:$(this).attr("class"),collection:t}),window.expanz.currentContextMenu=r.collection,s._handleContextMenuClick(n,i[0].get("actionName"),u,$(this).closest("[rowId]"))})})}}else $(o).addClass("emptyGrid"),$(o).removeClass("nonEmptyGrid"),$(o).append('<div id="noItemText" class="emptyListText">'+tt+"<\/div>");return o},renderGridUsingDefaultLayout:function(n,t,i,r){var e=this.$el.find("table#"+n),o,s,h,u,l,f,a,v,y,c,p,w,b;for(e.length<1&&(this.$el.append('<table class="grid" id="'+n+'"><\/table>'),e=this.$el.find("table#"+n)),$(e).html('<thead><tr class="item"><\/tr><\/thead><tbody><\/tbody>'),o=$(e).find("thead tr"),_.each(this.model.getAllColumns(),function(n){var t="<th ";t+=">"+n.get("label")+"<\/th>",o.append(t)}),this.model.hasActions&&o.append("<th>actions<\/th>"),s=this.model,o=$(e).find("tbody"),h=i;h<r;h++)u=t[h],l=(h-i)%2==1?"gridRowAlternate":"gridRow",u.get("displayStyle")==="separator"&&(l="gridRowGroup"),f='<tr id="'+u.id+'" type="'+u.get("type")+'" class="'+l+'">',a={},_.each(u.getAllCells(),function(n){f+='<td id="'+n.get("id")+'" field="'+n.get("field")+'" class="row'+u.id+" column"+n.get("id")+'">',s.getColumn(n.get("id"))&&s.getColumn(n.get("id")).get("datatype")==="BLOB"?f+='<img width="'+s.getColumn(n.get("id")).get("width")+'" src="'+n.get("value")+'"/>':n.get("value")&&(f+="<span>"+n.get("value")+"<\/span>",a[n.get("id")]=n.get("value")),f+="<\/td>"},u),this.model.hasActions&&(f+="<td>",_.each(this.model.getActions(),function(n){var r=s.id+"_"+u.id+"_"+n.get("actionName"),t=n.get("actionParams"),i="";_.each(t,function(n){var t=n.name,r=n.value,o=n.label;if(r=="@userInput.textinput"||r=="@userInput.numericinput"){var s=r=="@userInput.numericinput"?"numeric":"text",f=n.bindValueFromCellId,e="";f&&(e=" value='"+a[f]+"' "),i+="<label for='"+u.id+"_userinput_"+t+"'>"+(o||t)+"<\/label><input class='gridUserInput' type='text' format='"+s+"' "+e+" id='"+u.id+"_userinput_"+t+"'/>"}}),f+="<div style='display:inline' name='"+n.get("actionName")+"' actionParams='"+JSON.stringify(t)+"' bind='"+n.get("type")+"'> "+i+" <button id='"+r+"' attribute='submit'>"+n.get("label")+"<\/button><\/div>"}),f+="<\/td>"),f+="<\/tr>",o.append(f);return v=function(n){n.data.trigger("rowClicked",$(this))},y=function(n){n.data.trigger("rowDoubleClicked",$(this))},$("table#"+n+" tr").click(this,v),$("table#"+n+" tr").dblclick(this,y),c=this,p=function(){var t=$(this).closest("tr").attr("id"),n=$(this).parent(),i=n.attr("name"),r=JSON.parse(n.attr("actionParams"));c._handleActionClick($(this),t,i,r,n)},$("table#"+n+" tr [bind=method] > button").click(this,p),w=function(){var t=$(this).closest("tr").attr("id"),n=$(this).parent(),i=n.attr("name"),r=JSON.parse(n.attr("actionParams"));c._handleMenuActionClick(t,i,r,n)},$("table#"+n+" tr [bind=menuAction] > button").click(this,w),b=function(){var t=$(this).closest("tr").attr("id"),n=$(this).parent(),i=n.attr("name"),r=JSON.parse(n.attr("actionParams"));c._handleContextMenuClick(t,i,r,n)},$("table#"+n+" tr [bind=contextMenu] > button").click(this,b),e},renderPagingBar:function(n,t,i,r,u){var e="",c=this.model.getAllRows().length,o,f,s,h,l;if(c>0&&(o=Math.ceil(c/t),o>1))for($(i).is("table")?i.append("<tr class='paging'><td id='pagingBar' colspan='100%'><\/td><\/tr>"):i.append("<div id='pagingBar' class='paging'><\/div>"),e=i.find("#pagingBar"),f=0;f<o;f++)s=this.model.id+"BtnPage"+f,h="",f==n&&(h=" disabled='disabled'"),e.append("<input id='"+s+"' type='button' value='"+(f+1)+"' "+h+" />"),l=this,$(e).find("#"+s).click(function(){l.renderWithPaging(this.value-1,t,r,u)})},renderAsPopupGrid:function(n,t){var i=new expanz.models.ClientMessage({id:n+"PopUp",title:"",text:"",parent:this.model.parent}),r=new window.expanz.views.PopupView({id:i.id,model:i},$("body"));r.$el.append(t),r.center()},renderAsRotationBar:function(n,t,i,r){var e=$(n).find("li.rotatingItem").length,o=this,u=$(n).attr("id"),f;$(n).find("li.rotatingItem").hide(),f=0,$(n).find("li.rotatingItem").each(function(){return f>=r&&$(this).show(),f++,f-r>=t?!1:void 0}),$(n).find("#"+u+"NextBtn").length===0&&($(n).find("li.rotatingItem").last().after("<li class='rotatingButton'><button id='"+u+"NextBtn'>><\/button><\/li>"),$(n).find("#"+u+"NextBtn").unbind("click")),$("#"+u+"PrevBtn").length===0&&($(n).find("li.rotatingItem").first().before("<li class='rotatingButton'><button  id='"+u+"PrevBtn'><<\/button><\/li>"),$(n).find("#"+u+"PrevBtn").unbind("click")),r>0?($(n).find("#"+u+"PrevBtn").click(function(){o.renderAsRotationBar($(n),t,i,Math.max(r-i,0))}),$(n).find("#"+u+"PrevBtn").show()):$(n).find("#"+u+"PrevBtn").hide(),f<e?($(n).find("#"+u+"NextBtn").click(function(){o.renderAsRotationBar($(n),t,i,Math.min(r+i,e-t))}),$(n).find("#"+u+"NextBtn").show()):$(n).find("#"+u+"NextBtn").hide()},itemTemplateName:function(){return this.options.templateName||this.model.id+"ItemTemplate"},itemTemplate:function(){var n=$("#"+this.itemTemplateName());return n.length===0&&(n=null),n},headerTemplate:function(){var n=$("#"+this.itemTemplateName()+"Header");return n.length===0&&(n=null),n},_handleActionClick:function(n,t,i,r,u){var f=!0;_.each(r,function(n){var r=n.name,i;n.value=="@userInput.textinput"||n.value=="@userInput.numericinput"?(i=u.find("#"+t+"_userinput_"+r),i.length>0&&i.val().length>0?n.value=i.val():f=!1):n.value=="@contextId"&&(n.value=t)}),f&&this.trigger("actionClicked",t,i,r,n)},_handleMenuActionClick:function(n,t,i){_.each(i,function(t){var i=t.name;t.value=="@contextId"&&(t.value=n)}),this.trigger("menuActionClicked",n,t,i)},_handleContextMenuClick:function(n,t,i){var r="";_.each(i,function(t){var i=t.name;t.value=="@contextId"&&(t.value=n),t.name=="contextObject"&&(r=t.value)}),r=r||t,this.trigger("contextMenuClicked",n,t,r,i)}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.LoginView=Backbone.View.extend({initialize:function(){if(this.model.bind("change:isLoggingIn",this.isLoggingInChanged(),this),this.messageControl=this.$el.find("[bind=messageControl]"),this.messageControl.length===0&&(this.messageControl=$("[bind=messageControl]")),this.messageControl.length!==0){var n=$(this.messageControl),t=new expanz.views.MessagesView({id:n.attr("id"),collection:this.model.messageCollection});n.html(t.render().el)}},events:{"click [type*='submit']":"attemptLogin"},attemptLogin:function(){this.model.messageCollection.reset();var n=this.$el.find("#username input"),t=this.$el.find("#password input");n.length===0||t.length===0?alert("Username or password field cannot be found on the page"):n.val().length===0||t.val().length===0?this.model.messageCollection.addErrorMessageByKey("loginOrPasswordEmpty"):this.model.login(n.val(),t.val(),this.$el.attr("type")=="popup")},isLoggingInChanged:function(){var n=this;return function(){var n=this.model.get("isLoggingIn");n?$("#signinButton").attr("disabled",!0):$("#signinButton").removeAttr("disabled")}}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.ActivityView=Backbone.View.extend({initialize:function(n){Backbone.View.prototype.initialize.call(n),n.key&&(this.key=n.key),this.messageControl=null,this.fieldViewCollection={},this.methodViewCollection={},this.dataControlViewCollection={},this.model.bind("error",this.updateError,this),this.model.bind("change:loading",this.loading,this),this.model.bind("change:deltaLoading",this.deltaLoading,this),this.model.bind("closingActivity",this.closeActivity,this)},updateError:function(n,t){this.model.messageCollection.addErrorMessageByText(t)},events:{"update:field":"update"},update:function(){},loading:function(){var t="Loading_"+this.id.replace(/\./g,"_"),n=this.$el.find("#"+t),i,r;n.length===0&&(this.$el.append('<div class="loading" id="'+t+'"><span>Loading content, please wait.. <img src="assets/images/loading.gif" alt="loading.." /><\/span><\/div>'),n=this.$el.find("#"+t)),i=this.model.get("loading"),i?(r=this.$el.offset(),this.$el.addClass("activityLoading"),n.css("position","absolute"),n.css("width","100%"),n.css("height","100%"),n.css("margin","0"),n.css("padding","0"),n.css("top","0px"),n.css("left","0px"),n.css("z-index","999"),n.css("overflow","hidden"),n.find("span").center(),n.css("background","url(data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==) center"),n.show()):(this.$el.removeClass("activityLoading"),n.hide())},deltaLoading:function(){var n=this.model.get("deltaLoading"),r,t;if(n.initiator!==undefined&&n.initiator!==null){var i=n.initiator.id,f=n.initiator.type,u=this.model.get(i);u?u.set({loading:n.isLoading}):f!="method"||n.isLoading||(r=".actionLoading[methodName='"+i+"'], [name='"+i+"'] .actionLoading, .actionLoading[autoUpdate='"+i+"']",t=this.$el.find(r).first().closest("[bind='DataControl']"),t&&t.length>0&&(t.find(r).removeAttr("disabled"),t.find(r).removeClass("actionLoading")))}},closeActivity:function(){this.trigger("closingActivity")},addFieldView:function(n){this.fieldViewCollection[n.id]===undefined&&(this.fieldViewCollection[n.id]=[]),this.fieldViewCollection[n.id].push(n);return},addMethodView:function(n){this.methodViewCollection[n.id]===undefined&&(this.methodViewCollection[n.id]=[]),this.methodViewCollection[n.id].push(n);return},addDataControlView:function(n){this.dataControlViewCollection[n.id]===undefined&&(this.dataControlViewCollection[n.id]=[]),this.dataControlViewCollection[n.id].push(n);return}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.DataControlView=Backbone.View.extend({initialize:function(n){Backbone.View.prototype.initialize.call(n),this.model.bind("change:xml",this.publishData,this)},itemSelected:function(n,t){this.model.updateItemSelected(n,t)},publishData:function(){this.$el.trigger("publishData",[this.model.get("xml"),this])}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.CheckboxesView=expanz.views.DataControlView.extend({publishData:function(){this.$el.html();var n=this;_.each(this.model.get("xml").find("Row"),function(t){var i=$(t).attr("id"),r=boolValue($(t).attr("selected"))===!0?' checked="checked" ':"";_.each($(t).find("Cell"),function(t){var f=$(t).text(),u=n.model.id.replace(/\./g,"_")+"_"+i;n.$el.append("<div><input "+r+" id='"+u+"' value='"+i+"' name='checkbox' type='checkbox'><\/input><span>"+f+"<\/span><\/div>"),n.$el.find("#"+u).click(function(){var t=$(this).val();$(this).is(":checked")||(t=-t),n.model.updateItemSelected(t)})})})}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.RadioButtonsView=expanz.views.DataControlView.extend({publishData:function(){this.$el.html();var n=this;_.each(this.model.get("xml").find("Row"),function(t){var i=$(t).attr("id"),r=boolValue($(t).attr("selected"))===!0?' checked="checked" ':"";_.each($(t).find("Cell"),function(t){var f=$(t).text(),u=n.model.id.replace(/\./g,"_")+"_"+i;n.$el.append("<div><input "+r+" id='"+u+"' value='"+i+"' name='radio' type='radio'><\/input><span>"+f+"<\/span><\/div>"),n.$el.find("#"+u).click(function(){n.model.updateItemSelected($(this).val())})})})}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.PopupView=Backbone.View.extend({width:"auto",cssClass:"popupView",divAttributes:"",initialize:function(n,t){if(Backbone.View.prototype.initialize.call(n),this.create(t),this.renderActions(),this.delegateEvents(this.events),window.expanz.currentPopup!==undefined)for(this.parentPopup=window.expanz.currentPopup;!this.parentPopup.$el.is(":visible");){if(this.parentPopup.parentPopup===undefined){this.parentPopup=undefined;break}this.parentPopup=this.parentPopup.parentPopup}window.expanz.currentPopup=this,this._activityView=null},events:{"click button":"buttonClicked"},renderActions:function(){},create:function(n){var r=n.find("#"+this.id),t,u,i;r.length>0&&r.remove(),t="",this.model.get("text")!==undefined&&this.model.get("text").length>0&&(t=this.model.get("text")),n.append("<div class='"+this.cssClass+"' id='"+this.id+"' "+this.divAttributes+" name='"+this.id+"'>"+t+"<\/div>"),this.setElement(n.find("#"+this.id)),this.createWindowObject(),this.model.get("url")!==undefined&&this.model.get("url").length>0?(u=this.model.get("url"),i=this,this.$el.load(u,function(){i.center(),i.trigger("contentLoaded")})):this.center()},createWindowObject:function(){this.el.dialog({modal:!0,width:this.width,title:this.model.get("title")})},setActivityView:function(n){this._activityView=n,n.bind("closingActivity",this.onActivityClosing,this)},onActivityClosing:function(){this.isActivityClosing=!0,this.close()},buttonClicked:function(){this.close()},onCloseWindow:function(){this.trigger("popupClosed"),this._activityView===null||this.isActivityClosing||this._activityView.closeActivity(),this.postCloseActions&&this.postCloseActions(this.model.get("title"))},close:function(){this.remove(),this.onCloseWindow()},center:function(){this.el.dialog("option","position","center")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.PicklistWindowView=window.expanz.views.PopupView.extend({divAttributes:" bind='DataControl' renderingType='grid' ",cssClass:"pickListPopup popupView"})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.UIMessage=window.expanz.views.PopupView.extend({width:"500px",cssClass:"uiMessage popupView",renderActions:function(){this.model.actions.forEach(function(n){var t,u,r,i;this.$el.find("[attribute=submit]").length===0&&this.$el.append("<br/>"),t=n.id,n.id=="close"?(t+=n.get("label").split(" ").join(""),this.$el.append('<div style="float:left"  bind="method" name="close" id="'+t+'"><button attribute="submit">'+n.get("label")+"<\/button><\/div>")):n.id!==this.model.id&&(this.$el.append('<div style="float:left" bind="method" name="'+n.id+'" id="'+t+'"><button attribute="submit">'+n.get("label")+"<\/button><\/div>"),u=new expanz.views.MethodView({el:$("div#"+n.id,this.el),id:n.id,model:n})),n.get("response")!==undefined&&(r=this.$el.find("#"+t+" button"),i=this,r.click(function(){i.postCloseActions(i.model.get("title")),n.get("response").find("closeWindow")&&(i.parentPopup!==undefined?i.parentPopup.close():window.expanz.logToConsole("Cannot find parent popup"))}))},this)},postCloseActions:function(n){(n=="Order Submitted"||n=="Order Saved")&&$("body").trigger("CheckoutFinished")}})}),$(function(){window.expanz=window.expanz||{},window.expanz.views=window.expanz.views||{},window.expanz.views.ManuallyClosedPopup=window.expanz.views.PopupView.extend({width:"auto",buttonClicked:function(){}})}),$(function(){function n(n){var t=null;return $(n).attr("bind")&&$(n).attr("bind").toLowerCase()==="login"&&(t=expanz.Factory.createLoginView(n)),t}window.expanz=window.expanz||{},window.expanz.security=window.expanz.security||{},window.expanz.security.getLoginPage=function(){return window.config._loginpage?window.config._loginpage:"login"},window.expanz.security.createLogin=function(t,i){t||(t=$("body"));var r=n(t,i);return},window.expanz.security.logout=function(){function n(){expanz.Storage.clearSession(),expanz.views.redirect(expanz.security.getLoginPage())}expanz.net.ReleaseSessionRequest({success:n,error:n})},window.expanz.security.showLoginPopup=function(){var t="",i;t='<div class="loginMsg">Sorry, your session timed out, please log in again.<\/div>',t+='<form bind="login" type="popup" name="login" action="javascript:">',t+='  <div name="username" id="username">',t+='    <input class="loginInput"  attribute="value" type="text" placeholder="Username"/>',t+="  <\/div>",t+='  <div name="password" id="password">',t+='    <input class="loginInput" attribute="value" type="password" placeholder="Password"/>',t+="  <\/div>",t+='  <div name="login" id="login">',t+='    <button id="signinButton" type="submit" attribute="submit">Login<\/button>',t+="  <\/div>",t+='  <div bind="messageControl" class="error">',t+="  <\/div>",t+="<\/form>",i=window.expanz.showManuallyClosedPopup(t,"Login","ExpanzLoginPopup"),$("#username input").focus(),n(i.$el.find("[bind=login]"));return}}),$(function(){function r(n,t,i){var u=[],r=[];return $(n).attr("bind")&&$(n).attr("bind").toLowerCase()==="activity"?r.push(n):_.each($(n).find("[bind=activity]"),function(n){r.push(n)}),_.each(r,function(){var r=expanz.Factory.createActivityView(n),f=i||getQueryParameterByName(r.model.get("name")+(r.model.get("style")||"")+"initialKey");r.model.set({key:f}),r.model.load(t),u.push(r)}),u}function u(n,t){var i=new expanz.menu.AppSiteMenu,r=f(expanz.Storage.getProcessAreaList(),t);r.length>0&&(i.processAreas=r),i.load(n)}function f(n,t,i){var r=[];return _.each(n,function(n){if(t||n.activities.length>0||n.pa.length>0){var u=new expanz.menu.ProcessAreaMenu(n.id,n.title);i&&(u.parent=i),_.each(n.activities,function(n){(t||n.url!==""&&n.url.length>1)&&u.activities.push(new expanz.menu.ActivityMenu(n.name,n.style,n.title,n.url,n.img))}),n.pa.length>0&&(u.pa=loadProcessArea(n.pa,t,u)),(t||u.activities.length>0)&&r.push(u)}}),r}var i,n,t;if(window.expanz=window.expanz||{},window.expanz.helper=window.expanz.helper||{},window.expanz.Storage=window.expanz.Storage||{},window.openActivityViews=[],window.messageControlView=null,window.expanz.logToConsole=function(n){typeof console!="undefined"&&console.log&&console.log(n)},window.expanz.getMaintenancePage=function(){return window.config._maintenancePage?window.config._maintenancePage:"maintenance"},window.expanz.isOnMaintenance=function(){var n=window.config._onMaintenance;return n===!0?!0:!1},window.expanz.CreateActivity=function(n,t,i,u){n||(n=$("body"));var f=r(n,t,i);return _.each(f,function(n){window.openActivityViews.push(n),u!==undefined&&u.setActivityView(n)}),f},window.expanz.showManuallyClosedPopup=function(n,t,i){n=unescape(n);var r=new expanz.models.ClientMessage({id:i,title:t,text:n});return new window.expanz.views.ManuallyClosedPopup({id:r.id,model:r},$("body"))},window.expanz.openActivity=function(n,t,i,r){var u=function(u){var e,o,f;u.url===null&&window.expanz.logToConsole("Url of activity not found"),u.onRequest=="popup"?(e=window.expanz.Storage.getActivityHandle(n,t),e!==undefined&&(window.expanz.Storage.clearActivityHandle(n,t),expanz.net.CloseActivityRequest(e)),o=new expanz.models.ClientMessage({id:"ActivityRequest",url:u.url+"&random="+(new Date).getTime(),title:unescape(r||u.title||"")}),f=new window.expanz.views.ManuallyClosedPopup({id:o.id,model:o},$("body")),f.bind("contentLoaded",function(){expanz.CreateActivity(f.$el.find("[bind=activity]"),null,i,f)})):window.location=u.url+"&random="+(new Date).getTime()+"&"+n+t+"initialKey="+i};window.expanz.helper.findActivityMetadata(n,t,u)},window.expanz.findOpenActivityViewByHandle=function(n){if(window&&window.openActivityViews)for(var t=0;t<window.openActivityViews.length;t++)if(window.openActivityViews[t]!==undefined&&window.openActivityViews[t].model.get("handle")==n)return window.openActivityViews[t];return null},window.expanz.findOpenActivityViewByModel=function(n){if(window&&window.openActivityViews)for(var t=0;t<window.openActivityViews.length;t++)if(window.openActivityViews[t]!==undefined&&window.openActivityViews[t].model===n)return window.openActivityViews[t];return null},window.expanz.OnActivityClosed=function(n){if(window&&window.openActivityViews)for(var t=0;t<window.openActivityViews.length;t++)if(window.openActivityViews[t]!==undefined&&window.openActivityViews[t].model.get("handle")==n){delete window.openActivityViews[t];return}},window.expanz.helper.findActivityMetadata=function(n,t,i){var r=expanz.Storage.getFormMapping();$(r).find("activity").each(function(){var u=$(this).attr("name"),f=getPageUrl($(this).attr("form")),e=$(this).attr("onRequest"),o=$(this).attr("title"),s=$(this).attr("style"),r;if(u==n&&s==t){r={},r.url=f,r.onRequest=e,r.title=o,i(r);return}})},document.location.href.indexOf(window.expanz.getMaintenancePage())===-1&&(window.expanz.isOnMaintenance()&&expanz.views.redirect(window.expanz.getMaintenancePage()),i=(new Date).getTime(),n=window.expanz.Storage.getLastPingSuccess(),(n===undefined||i-n>6e4)&&expanz.net.WebServerPing(3)),window.console||(window.console={log:function(){}}),window.expanz.logToConsole("Loading menu, setting callbacks and creating activities"),$.browser.msie&&$.browser.version=="6.0"&&(loadjscssfile("//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js","js"),window.attachEvent("onload",function(){CFInstall.check({mode:"overlay"})})),window.expanz.Dashboards=new window.expanz.models.Dashboards,_.each($("[bind=menu]"),function(n){u($(n),!1)}),expanz.security.createLogin($("[bind=login]")),_.each($('[bind=activity][autoLoad!="false"]'),function(n){expanz.CreateActivity($(n))}),_.each($("body").find("[requiresRole]"),function(n){var t=$(n).attr("requiresRole"),r,i;if(t!==null&&t!==""){for(r=!1,t=t.split(" "),i=0;i<t.length;i++)if(expanz.Storage.hasRole(t[i])){r=!0;break}r!==!0&&$(n).hide()}}),t=$("body").attr("expanzPlugin"),t)switch(t){case"kendo":typeof useKendo=="function"?useKendo():window.expanz.logToConsole("useKendo method is undefined");break;case"kendoMobile":typeof useKendoMobile=="function"?useKendoMobile():window.expanz.logToConsole("useKendoMobile method is undefined")}}),$(function(){function n(n){var t=$(n),i=function(n,i,r){var u=null,f;return i!==null&&(f=t.attr("timeFormat")!==undefined?t.attr("timeFormat"):window.config._timeFormat,f===undefined&&(f=12),u=f==12?r.attributes.timeAMPM:r.attributes.time24),t.is("input")?t.val(u):t.text(u||""),u};t.bind("valueUpdated",i)}$("body").find("[renderingType=timeinput]").each(function(){var t=new n(this)})})
//@ sourceMappingURL=expanz-sdk.min.js.map