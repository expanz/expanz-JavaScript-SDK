function useKendo(){expanz.UIplugin="kendo";renderKendoComponents();useKendoPopups();window.expanz.Views.ContextMenuView.prototype.createContextMenu=function(){this.contextMenuEl.find("ul").kendoMenu({orientation:"vertical"});this.contextMenuEl.show()}}function renderKendoComponents(A){if(A===undefined){A=$("body")}if(A.find("[renderingType=combobox]").length>0){A.find("[renderingType=combobox]").KendoComboBoxAdapter()}if(A.find("[renderingType=dropdownlist]").length>0){A.find("[renderingType=dropdownlist]").KendoDropDownListAdapter()}if(A.find("[bind=menu] > ul.menu").length>0){A.find("[bind=menu] > ul.menu").kendoMenu()}if(A.find("[renderingType=numerictextbox]").length>0){A.find("[renderingType=numerictextbox]").kendoNumericTextBox({min:1,max:99,step:1,format:"n0"})}}function useKendoMobile(){expanz.UIplugin="kendoMobile"}$.fn.KendoComboBoxAdapter=function(){var A=$(this).kendoComboBox({dataTextField:"text",dataValueField:"value"});var D=A.data("kendoComboBox");var C=function(F,E){var H=[];_.each($(E).find("Row"),function(J){var I=$(J).attr("id");_.each($(J).find("Cell"),function(K){H.push({text:$(K).text(),value:I==0?$(K).text():I})})});var G=new kendo.data.DataSource({data:H});D.dataSource=G;G.read();D.refresh();if(A.val()!==undefined){D.value(A.val())}};var B=function(E,F){D.value(F)};A.bind("valueUpdated",B);A.bind("publishData",C)};$.fn.KendoDropDownListAdapter=function(){var A=$(this).kendoDropDownList({dataTextField:"text",dataValueField:"value"});var D=A.data("kendoDropDownList");var E=null;if($(this).attr("emptyItemLabel")!==undefined){E=$(this).attr("emptyItemLabel")}var C=function(G,F){var I=[];if(E!=null){I.push({text:E,value:""})}_.each($(F).find("Row"),function(K){var J=$(K).attr("id");_.each($(K).find("Cell"),function(L){I.push({text:$(L).text(),value:J==0?$(L).text():J})})});var H=new kendo.data.DataSource({data:I});D.dataSource=H;H.read();D.refresh();if(A.val()!==undefined){D.value(A.val())}};var B=function(F,G){D.value(G)};A.bind("publishData",C);A.bind("valueUpdated",B)};function useKendoPopups(){window.expanz.Views.PopupView.prototype.createWindowObject=function(){var C=this.model.getAttr("title");var B=this;this.el.kendoWindow({visible:true,title:this.model.getAttr("title")?this.model.getAttr("title"):"",modal:true,width:this.width,close:function(){B.trigger("popupClosed");if(B.postCloseActions){B.postCloseActions(C)}}});var A=this.el;this.el.data("kendoWindow").bind("open",function(){$(A).parent().find(".k-window-title").html($(A).parent().find(".k-window-title").text())})};window.expanz.Views.PopupView.prototype.close=function(){if(this.el.data("kendoWindow")){this.el.data("kendoWindow").destroy()}};window.expanz.Views.PopupView.prototype.center=function(){this.el.data("kendoWindow").center();this.el.data("kendoWindow").open()}}function createActivityWithKendoTabs(C,B,D){var F=[];var A=B.length;var E=function(H){var G=(H.item.innerText||H.item.textContent);F[G]=true;if(Object.size(F)==A){addPlaceHolderCapabilities();F=[];expanz.CreateActivity($(H.item).parents("[bind=activity]"),D)}};$(C).kendoTabStrip({contentUrls:B,contentLoad:E});_.each(C.data("kendoTabStrip").tabGroup.children().not("[class*=k-state-active]").not("[class*=k-tab-on-top]"),function(G){C.data("kendoTabStrip").reload($(G))})}$.fn.KendoTreeAdapter=function(P){var F=$(this);var L=true;var I="title";var K="id";var C=true;var O=[];var H=true;var E=null;var N={success:function(){if(H){F.removeClass("treeSelectionLoading");var Q="LoadingTree_"+F.attr("id");var R=$(F).find("#"+Q);if(R){R.hide()}}if(E){E.call()}}};var G=null;var B=function(R,U,Q){if(!L&&!Q){return }R.itemSelected(U,N);if(H){var S="LoadingTree_"+F.attr("id");var T=$(R.el).find("#"+S);if(T.length===0){$(R.el).append('<div class="loading" id="'+S+'"><span> </span></div>');T=$(R.el).find("#"+S)}T.css("position","absolute");T.css("width","100%");T.css("height","100%");T.css("margin","0");T.css("padding","0");T.css("top","0px");T.css("left","0px");T.css("z-index","999");T.css("overflow","hidden");T.css("background","url(data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==) center");T.show();F.addClass("treeSelectionLoading")}};var M=function(T,S,U){var R;if(S instanceof Array){S=str.join("|")}if(S===null||S===""){R=U}else{var Q=new RegExp(S,"i");var R=[];_.each(U,function(V){var X={};X.text=V.text;X.expanded=V.expanded;var W=[];_.each(V.items,function(Y){if(Y.text.match(Q)){W.push(Y)}});if(W.length>0){X.items=W;R.push(X)}})}F.html("");F.removeClass("k-widget k-treeview k-reset");F.kendoTreeView({dataSource:R})};if(P){if(P.labelAttribute!==undefined){I=P.labelAttribute}if(P.idAttribute!==undefined){K=P.idAttribute}if(P.selectionCallback!==undefined){E=P.selectionCallback}if(P.onSelection!==undefined){B=P.onSelection}if(P.parentSelectable!==undefined){L=P.parentSelectable}if(P.expandedOnLoad!==undefined){C=P.expandedOnLoad}if(P.filteringInput!==undefined){O=P.filteringInput}if(P.runAfterPublish!==undefined){G=P.runAfterPublish}if(P.filterData!==undefined){M=P.filterData}if(P.displayLoading!==undefined){H=P.displayLoading}}var A=function(R){var Q=[];_.each($(R).children(),function(S){var U={text:$(S).attr(I),value:$(S).attr(K),allAttributes:$(S),expanded:C};if($(S).attr("Type")=="parent"){var T=A(S);if(T.length>0){U.items=T}}Q.push(U)});return Q};var D=function(R){var T=$(R).attr(K);var S={};S.text=$(R).attr(I);S.expanded=C;S.allAttributes=$(R).getAttributes();var Q=A(R);if(Q.length>0){S.items=Q}return S};var J=function(V,S,R){window.expanz.logToConsole("KendoTreeAdapter publishData");var U=S;var W=[];var X="";if($(S).find("Rows").length>0){S=$(S).find("Rows")}_.each($(S).children(),function(Y){var Z=D(Y);X=Y.tagName;W.push(Z)});F.kendoTreeView({dataSource:W});F.data("kendoTreeView").bind("select",function(Z){var a=Z.node.firstChild.textContent||Z.node.firstChild.innerText;var Y=undefined;$(U).find("["+I+"]").each(function(){if(a===$(this).attr(I)){Y=$(this)}});if(B){B(R,Y.attr("id"),!Y.is(X))}$(F).trigger("TreeSelectionChanged",{id:Y.attr("id"),text:a,parentId:Y.parent().attr("id"),parentText:Y.parent().attr(I)})});if(O&&O.length>0){var T=function(Y){M(Y,$(this).val(),W)};var Q=function(Y){M(Y,$(this).attr("filter"),W)};_.each(O,function(Y){if($(Y).is("input")){$(Y).val("");$(Y).bind("change",T)}else{if($(Y).is("button")){$(Y).bind("click",Q)}}})}if(G){G(U)}};$(this).bind("publishData",J);$(this).bind("filterData",M)};$.fn.KendoPanelBarAdapter=function(K){var E=$(this);var J=true;var G="title";var I="id";var B=true;var F={};var C=null;var D=null;var A=function(M,N,L){if(!J&&!L){return }M.itemSelected(N,C)};if(K){if(K.labelAttribute!==undefined){G=K.labelAttribute}if(K.idAttribute!==undefined){I=K.idAttribute}if(K.selectionCallback!==undefined){C=K.selectionCallback}if(K.onSelection!==undefined){A=K.onSelection}if(K.parentSelectable!==undefined){J=K.parentSelectable}if(K.expandedOnLoad!==undefined){B=K.expandedOnLoad}if(K.runAfterPublish!==undefined){D=K.runAfterPublish}if(K.staticElements!==undefined){F=K.staticElements}}var H=function(P,N,L){window.expanz.logToConsole("KendoPanelBarAdapter publishData");var O=N;var Q=[];var M="";if($(N).find("Rows").length>0){N=$(N).find("Rows")}_.each($(N).children(),function(S){var U=$(S).attr(I);var T={};T.text=$(S).attr(G);T.expanded=B;T.allAttributes=$(S).getAttributes();var R=[];_.each($(S).children(),function(V){M=V.tagName;R.push({text:$(V).attr(G),value:$(V).attr(I),allAttributes:$(V)})});if(R.length>0){R.sort(getObjectSortAscendingFunction("text"));T.items=R}Q.push(T)});Q.sort(getObjectSortAscendingFunction("text"));_.each(F,function(R){if(R.position!=undefined&&R.position=="end"){Q.push({text:$(R).attr("label")})}else{Q.unshift({text:$(R).attr("label")})}});E.kendoPanelBar({dataSource:Q});E.children("li").addClass("level1");E.children("li").find("ul").children("li").addClass("level2");E.data("kendoPanelBar").bind("select",function(T){var U=T.item.firstChild.textContent||T.item.firstChild.innerText;var R=false;if(F.length>0){_.each(F,function(V){if(U===V.label){R=true;expanz.Net.MethodRequest(V.method,[{name:"contextObject",value:V.contextObject}],null,L.model.getAttr("parent"))}})}if(!R){var S=undefined;$(O).find("["+G+"]").each(function(){if(U===$(this).attr(G)){S=$(this)}});if(A){A(L,S.attr("id"),S.is(M))}}});if(D){D(O)}$(this).trigger("dataPublished")};$(this).bind("publishData",H)};$.fn.KendoMobileListAdapter=function(D){var A=$(this);var C=true;var E="title";var G="id";var H=null;var B=function(J,K,I){if(!C&&!I){return }J.itemSelected(K,H)};if(D){if(D.labelAttribute!=undefined){E=D.labelAttribute}if(D.idAttribute!=undefined){G=D.idAttribute}if(D.selectionCallback!=undefined){H=D.selectionCallback}if(D.onSelection!=undefined){B=D.onSelection}if(D.parentSelectable!=undefined){C=D.parentSelectable}}var F=function(M,K,I){window.expanz.logToConsole("KendoMobileListAdapter publishData");var L=K;var N=new Array();var J="";if($(K).find("Rows").length>0){K=$(K).find("Rows")}_.each($(K).children(),function(P){var O=new Array();_.each($(P).children(),function(Q){N.push({name:$(Q).attr(E),category:$(P).attr(E),id:$(Q).attr(G)})})});A.kendoMobileListView({dataSource:kendo.data.DataSource.create({data:N,group:"category"}),template:"${name}",click:function(O){window.expanz.logToConsole(O.dataItem.id)}})};$(this).bind("publishData",F)};